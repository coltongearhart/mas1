<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Linear regression – MAS I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./islr-4.html" rel="next">
<link href="./islr-2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./partC-glm.html">Extended Linear Models</a></li><li class="breadcrumb-item"><a href="./islr-3.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./partC-glm.html">Extended Linear Models</a></li><li class="breadcrumb-item"><a href="./islr-3.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear regression</span></a></li></ol></nav>
      <div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear regression</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MAS I</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./partA-prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./placeholder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Placeholder</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./partB-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./placeholder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Placeholder</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./partC-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extended Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./islr-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Statistical learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./islr-3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./islr-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Classification</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#notes" id="toc-notes" class="nav-link active" data-scroll-target="#notes"><span class="header-section-number">4.1</span> Notes</a>
  <ul>
<li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression"><span class="header-section-number">4.1.1</span> Simple linear regression</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span class="header-section-number">4.1.2</span> Multiple linear regression</a></li>
  <li><a href="#other-considerations-in-the-regression-model" id="toc-other-considerations-in-the-regression-model" class="nav-link" data-scroll-target="#other-considerations-in-the-regression-model"><span class="header-section-number">4.1.3</span> Other considerations in the regression model</a></li>
  <li><a href="#comparison-of-linear-regression-with-k-nearest-neighbors" id="toc-comparison-of-linear-regression-with-k-nearest-neighbors" class="nav-link" data-scroll-target="#comparison-of-linear-regression-with-k-nearest-neighbors"><span class="header-section-number">4.1.4</span> Comparison of linear regression with <span class="math inline">\(K\)</span>-nearest neighbors</a></li>
  </ul>
</li>
  <li><a href="#lab" id="toc-lab" class="nav-link" data-scroll-target="#lab"><span class="header-section-number">4.2</span> Lab</a></li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">4.3</span> Exercises</a>
  <ul>
<li>
<a href="#conceptual" id="toc-conceptual" class="nav-link" data-scroll-target="#conceptual"><span class="header-section-number">4.3.1</span> Conceptual</a>
  <ul class="collapse">
<li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a></li>
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question 7</a></li>
  </ul>
</li>
  <li>
<a href="#applied" id="toc-applied" class="nav-link" data-scroll-target="#applied"><span class="header-section-number">4.3.2</span> Applied</a>
  <ul class="collapse">
<li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question 8</a></li>
  <li><a href="#question-9" id="toc-question-9" class="nav-link" data-scroll-target="#question-9">Question 9</a></li>
  <li><a href="#question-10" id="toc-question-10" class="nav-link" data-scroll-target="#question-10">Question 10</a></li>
  <li><a href="#question-11" id="toc-question-11" class="nav-link" data-scroll-target="#question-11">Question 11</a></li>
  <li><a href="#question-12" id="toc-question-12" class="nav-link" data-scroll-target="#question-12">Question 12</a></li>
  <li><a href="#question-13" id="toc-question-13" class="nav-link" data-scroll-target="#question-13">Question 13</a></li>
  <li><a href="#question-14" id="toc-question-14" class="nav-link" data-scroll-target="#question-14">Question 14</a></li>
  <li><a href="#question-15" id="toc-question-15" class="nav-link" data-scroll-target="#question-15">Question 15</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="notes" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="notes">
<span class="header-section-number">4.1</span> Notes</h2>
<section id="simple-linear-regression" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="simple-linear-regression">
<span class="header-section-number">4.1.1</span> Simple linear regression</h3>
<p><a href="https://coltongearhart.github.io/regression/notes-slr.html">https://coltongearhart.github.io/regression/notes-slr.html</a></p>
</section><section id="multiple-linear-regression" class="level3" data-number="4.1.2"><h3 data-number="4.1.2" class="anchored" data-anchor-id="multiple-linear-regression">
<span class="header-section-number">4.1.2</span> Multiple linear regression</h3>
<p><a href="https://coltongearhart.github.io/regression/notes-multiple-regression-1.html">https://coltongearhart.github.io/regression/notes-multiple-regression-1.html</a> and <a href="https://coltongearhart.github.io/regression/notes-multiple-regression-2.html">https://coltongearhart.github.io/regression/notes-multiple-regression-2.html</a></p>
</section><section id="other-considerations-in-the-regression-model" class="level3" data-number="4.1.3"><h3 data-number="4.1.3" class="anchored" data-anchor-id="other-considerations-in-the-regression-model">
<span class="header-section-number">4.1.3</span> Other considerations in the regression model</h3>
<p><a href="https://coltongearhart.github.io/regression/notes-reg-models-quan-and-qual.html">https://coltongearhart.github.io/regression/notes-reg-models-quan-and-qual.html</a></p>
<p>Things to study more from other text</p>
<ul>
<li><p>Leverage</p></li>
<li><p>VIF</p></li>
</ul></section><section id="comparison-of-linear-regression-with-k-nearest-neighbors" class="level3" data-number="4.1.4"><h3 data-number="4.1.4" class="anchored" data-anchor-id="comparison-of-linear-regression-with-k-nearest-neighbors">
<span class="header-section-number">4.1.4</span> Comparison of linear regression with <span class="math inline">\(K\)</span>-nearest neighbors</h3>
<p>As discussed earlier, <em>non-parametric</em> methods do not explicitly assume a parametric form for <span class="math inline">\(f(X)\)</span>, and thereby provide an alternative and more flexible approach for performing regression. Here we consider one of the simplest and best-known non-parametric methods,<em><span class="math inline">\(K\)</span>-nearest neighbors regression </em> (KNN regression). The KNN regression method is closely related to the KNN classifier discussed in the previous chapter. <strong>Given a value for <span class="math inline">\(K\)</span> and a prediction point <span class="math inline">\(x_0\)</span>, KNN regression first identifies the <span class="math inline">\(K\)</span> training observations that are closest to <span class="math inline">\(x_0\)</span>, represented by <span class="math inline">\(\cal{N}_0\)</span>. It then estimates <span class="math inline">\(f(x_0)\)</span> using the average of all the training responses in <span class="math inline">\(\cal{N}_0\)</span></strong>. In other words,</p>
<p><span class="math display">\[
\hat{f}(x_0) = \frac{1}{K}\sum_{x_i \in \cal{N}_0} y_i
\]</span></p>
<p><img src="files/images/3-knn-regression.png" class="img-fluid" style="width:50.0%"></p>
<p>We see that when <span class="math inline">\(K = 1\)</span>, the KNN fit perfectly interpolates the training observations, and consequently takes the form of a step function. When <span class="math inline">\(K = 9\)</span>, the KNN fit still is a step function, but averaging over nine observations results in much smaller regions of constant prediction, and consequently a smoother fit. <strong>In general, the optimal value for K will depend on the bias-variance tradeoff</strong>.</p>
<p>A small value for <span class="math inline">\(K\)</span> provides the most flexible fit, which will have low bias but high variance. This variance is due to the fact that the prediction in a given region is entirely dependent on just one observation. In contrast, larger values of <span class="math inline">\(K\)</span> provide a smoother and less variable fit; the prediction in a region is an average of several points, and so changing one observation has a smaller effect. However, the smoothing may cause bias by masking some of the structure in <span class="math inline">\(f(X)\)</span>.</p>
<p>In what setting will a parametric approach such as least squares linear regression outperform a non-parametric approach such as KNN regression? The answer is simple: <strong>the parametric approach will outperform the non- parametric approach if the parametric form that has been selected is close to the true form of <span class="math inline">\(f\)</span>.</strong></p>
<p><img src="files/images/3-knn-comparison.png" class="img-fluid" style="width:50.0%"></p>
<p>Figure 3.17 provides an example with data generated from a one-dimensional linear regression model. The black solid lines represent <span class="math inline">\(f(X)\)</span>, while the blue curves correspond to the KNN fits using <span class="math inline">\(K = 1\)</span> and <span class="math inline">\(K = 9\)</span>. In this case, the <span class="math inline">\(K = 1\)</span> predictions are far too variable, while the smoother <span class="math inline">\(K = 9\)</span> fit is much closer to <span class="math inline">\(f(X)\)</span>. **However, since the true relationship is linear, it is hard for a non-parametric approach to compete with linear regression: a non-parametric approach incurs a cost in variance that is not offset by a reduction in bias.*</p>
<p><img src="files/images/3-knn-comparison-3.png" class="img-fluid" style="width:50.0%"></p>
<p>Figure 3.19 examines the relative performances of least squares regression and KNN under increasing levels of non-linearity in the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. In more non-linear situation, KNN substantially outperforms linear regression for all values of <span class="math inline">\(K\)</span>. <strong>Note that as the extent of non-linearity increases, there is little change in the test set MSE for the non-parametric KNN method, but there is a large increase in the test set MSE of linear regression.</strong></p>
<p>In a real life situation in which the true relationship is unknown, one might suspect that KNN should be favored over linear regression because it will at worst be slightly inferior to linear regression if the true relationship is linear, and may give substantially better results if the true relationship is non-linear. But in reality, even when the true relationship is highly non-linear, KNN may still provide inferior results to linear regression. <strong>But in higher dimensions, KNN often performs worse than linear regression.</strong></p>
<p><img src="files/images/3-knn-comparison-4.png" class="img-fluid" style="width:50.0%"></p>
<p>Figure 3.20 considers the same strongly non-linear situation as in the second row of Figure 3.19, except that we have added additional <em>noise</em> predictors that are not associated with the response. But for <span class="math inline">\(p = 3\)</span> the results are mixed, and for <span class="math inline">\(p \ge 4\)</span> linear regression is superior to KNN. In fact, the increase in dimension has only caused a small deterioration in the linear regression test set MSE, but it has caused more than a ten-fold increase in the MSE for KNN. <strong>This decrease in performance as the dimension increases is a common problem for KNN, and results from the fact that in higher dimensions there is effectively a reduction in sample size</strong>. In this data set there are 50 training observations; when <span class="math inline">\(p = 1\)</span>, this provides enough information to accurately estimate <span class="math inline">\(f(X)\)</span>. However, spreading 50 observations over <span class="math inline">\(p = 20\)</span> dimensions results in a phenomenon in which a given observation has <em>no nearby neighbors</em> – this is the so-called <em>curse of dimensionality</em>.</p>
<p><strong>As a general rule, parametric methods will tend to outperform non-parametric approaches when there is a small number of observations per predictor. Even when the dimension is small, we might prefer linear regression to KNN from an interpretability standpoint. If the test MSE of KNN is only slightly lower than that of linear regression, we might be willing to forego a little bit of prediction accuracy for the sake of a simple model that can be described in terms of just a few coefficients, and for which p-values are available.</strong></p>
</section></section><section id="lab" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="lab">
<span class="header-section-number">4.2</span> Lab</h2>
<p>&lt; just basic regression commands &gt;</p>
<p>Some key points</p>
<ul>
<li>
<p><code>hatvalues(&lt; mod &gt;)</code>: Computes the hat values for each observation.</p>
<ul>
<li>Then can run <code>hatvalues(&lt; mod &gt;) %&gt;% which.max</code> to get the largest one.</li>
</ul>
</li>
<li><p><code><a href="https://rdrr.io/pkg/car/man/vif.html">car::vif()</a></code>: Computes the VIF for each predictor.</p></li>
<li>
<p>In the formula, <code><a href="https://rdrr.io/r/stats/poly.html">poly()</a></code> by default orthogonalizes the predictors, so they are not simply a sequence of higher powers of the argument.</p>
<ul>
<li>However, a linear model applied to the output of the <code><a href="https://rdrr.io/r/stats/poly.html">poly()</a></code> function will have the same fitted values as a linear model applied to the raw polynomials (<code>raw = TRUE</code>; although the coefficient estimates, standard errors, and p-values will differ).</li>
</ul>
</li>
<li><p><code>contrasts(&lt; factor &gt;)</code>: Returns the coding that R uses for the dummy variables.</p></li>
</ul></section><section id="exercises" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">4.3</span> Exercises</h2>
<section id="conceptual" class="level3" data-number="4.3.1"><h3 data-number="4.3.1" class="anchored" data-anchor-id="conceptual">
<span class="header-section-number">4.3.1</span> Conceptual</h3>
<section id="question-1" class="level4"><h4 class="anchored" data-anchor-id="question-1">Question 1</h4>
<blockquote class="blockquote">
<p>Describe the null hypotheses to which the p-values shown below correspond. Explain what conclusions you can draw based on these p-values. Your explanation should be phrased in terms of the predictors, rather than in terms of the coefficients of the linear model.</p>
</blockquote>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     1.04     0.271       3.85 1.73e- 4
2 Petal.Width     0.558    0.123       4.55 1.10e- 5
3 Petal.Length   -0.586    0.0621     -9.43 8.75e-17
4 Sepal.Length    0.607    0.0622      9.77 1.20e-17</code></pre>
</div>
</div>
<p>For <code>Petal.Length</code>:</p>
<p><span class="math display">\[
\begin{align*}
H_0&amp;: \beta_{\text{Petal.Length}} = 0 \\
H_A&amp;: \beta_{\text{Petal.Length}} \ne 0
\end{align*}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit model</span></span>
<span><span class="va">mod_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Petal.Width</span> <span class="op">+</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="va">Sepal.Length</span>, data <span class="op">=</span> <span class="va">iris</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># verify p-value</span></span>
<span><span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_iris</span><span class="op">)</span><span class="op">[</span><span class="st">"Petal.Length"</span><span class="op">]</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">mod_iris</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="va">se_beta_hats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_iris</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_beta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">se_beta_hats</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">beta_hat</span> <span class="op">/</span> <span class="va">se_beta_hat</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/nobs.html">nobs</a></span><span class="op">(</span><span class="va">mod_iris</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_iris</span><span class="op">)</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">%&gt;%</span> <span class="va">as.numeric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Petal.Length 
0.00000000000000008753029 </code></pre>
</div>
</div>
</section><section id="question-2" class="level4"><h4 class="anchored" data-anchor-id="question-2">Question 2</h4>
<blockquote class="blockquote">
<p>Carefully explain the differences between the KNN classifier and KNN regression methods.</p>
</blockquote>
<p>Simply stated, The KNN classifier is categorical and assigns a value based on the most frequent observed category among <span class="math inline">\(K\)</span> nearest neighbors, whereas KNN regression assigns a continuous variable, the average of the response variables for the <span class="math inline">\(K\)</span> nearest neighbors. This represents two different summary functions, which are: for classification</p>
<p><span class="math display">\[
\hat{f}(x_0) = \text{max}_j\bigg\{\frac{1}{K}\sum_{x_i \in \cal{N}_0} I(y_i = j)\bigg\}
\]</span></p>
<p>and for regression</p>
<p><span class="math display">\[
\hat{f}(x_0) = \frac{1}{K}\sum_{x_i \in \cal{N}_0} y_i
\]</span></p>
</section><section id="question-3" class="level4"><h4 class="anchored" data-anchor-id="question-3">Question 3</h4>
<blockquote class="blockquote">
<p>Suppose we have a data set with five predictors, <span class="math inline">\(X_1\)</span> = GPA, <span class="math inline">\(X_2\)</span> = IQ, <span class="math inline">\(X_3\)</span> = Level (1 for College and 0 for High School), <span class="math inline">\(X_4\)</span> = Interaction between GPA and IQ, and <span class="math inline">\(X_5\)</span> = Interaction between GPA and Level. The response is starting salary after graduation (in thousands of dollars). Suppose we use least squares to fit the model, and get <span class="math inline">\(\hat\beta_0 = 50\)</span>, <span class="math inline">\(\hat\beta_1 = 20\)</span>, <span class="math inline">\(\hat\beta_2 = 0.07\)</span>, <span class="math inline">\(\hat\beta_3 = 35\)</span>, <span class="math inline">\(\hat\beta_4 = 0.01\)</span>, <span class="math inline">\(\hat\beta_5 = -10\)</span>.</p>
</blockquote>
<blockquote class="blockquote">
<ol type="a">
<li>Which answer is correct, and why?
<ol type="i">
<li>For a fixed value of IQ and GPA, high school graduates earn more on average than college graduates.</li>
<li>For a fixed value of IQ and GPA, college graduates earn more on average than high school graduates.</li>
<li>For a fixed value of IQ and GPA, high school graduates earn more on average than college graduates provided that the GPA is high enough.</li>
<li>For a fixed value of IQ and GPA, college graduates earn more on average than high school graduates provided that the GPA is high enough.</li>
</ol>
</li>
</ol>
</blockquote>
<ol type="i">
<li><p>False: <span class="math inline">\(\hat{\beta}_3 &gt; 0\)</span></p></li>
<li><p>False: Have to take into account the interactions</p></li>
<li><p>True: <span class="math inline">\(\hat{\beta}_5 = -10\)</span>, which means the slope for GPA decreases by 10 for college students. So for large enough GPAs, high school plane surpasses that of college</p></li>
<li><p>False: above reason</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fitted response curve</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gpa</span>, <span class="va">iq</span>, <span class="va">level</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">50</span> <span class="op">+</span></span>
<span>  <span class="va">gpa</span> <span class="op">*</span> <span class="fl">20</span> <span class="op">+</span></span>
<span>  <span class="va">iq</span> <span class="op">*</span> <span class="fl">0.07</span> <span class="op">+</span></span>
<span>  <span class="va">level</span> <span class="op">*</span> <span class="fl">35</span> <span class="op">+</span></span>
<span>  <span class="va">gpa</span> <span class="op">*</span> <span class="va">iq</span> <span class="op">*</span> <span class="fl">0.01</span> <span class="op">+</span></span>
<span>  <span class="va">gpa</span> <span class="op">*</span> <span class="va">level</span> <span class="op">*</span> <span class="op">-</span><span class="fl">10</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># set predictors</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">200</span>, length <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate response</span></span>
<span><span class="va">college</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, FUN <span class="op">=</span> <span class="va">model</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">t</span></span>
<span><span class="va">high_school</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, FUN <span class="op">=</span> <span class="va">model</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">t</span></span>
<span></span>
<span><span class="co"># plot surfaces</span></span>
<span><span class="fu">plot_ly</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_surface</span><span class="op">(</span></span>
<span>    z <span class="op">=</span> <span class="op">~</span><span class="va">college</span>,</span>
<span>    colorscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rgb(107,184,214)"</span>, <span class="st">"rgb(0,90,124)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    colorbar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"College"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">add_surface</span><span class="op">(</span></span>
<span>    z <span class="op">=</span> <span class="op">~</span><span class="va">high_school</span>,</span>
<span>    colorscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rgb(255,112,184)"</span>, <span class="st">"rgb(128,0,64)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    colorbar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"High school"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span>scene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GPA"</span><span class="op">)</span>,</span>
<span>    yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"IQ"</span><span class="op">)</span>,</span>
<span>    zaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Salary"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in layout(., scene = list(xaxis = list(title = "GPA"), yaxis = list(title = "IQ"), : unused argument (scene = list(xaxis = list(title = "GPA"), yaxis = list(title = "IQ"), zaxis = list(title = "Salary")))</code></pre>
</div>
</div>
<blockquote class="blockquote">
<ol start="2" type="a">
<li>Predict the salary of a college graduate with IQ of 110 and a GPA of 4.0.</li>
</ol>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">model</span><span class="op">(</span>gpa <span class="op">=</span> <span class="fl">4</span>, iq <span class="op">=</span> <span class="fl">110</span>, level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 137.1</code></pre>
</div>
</div>
<blockquote class="blockquote">
<ol start="3" type="a">
<li>True or false: Since the coefficient for the GPA/IQ interaction term is very small, there is very little evidence of an interaction effect. Justify your answer.</li>
</ol>
</blockquote>
<p>False. Scale is based on units, need information about the significance.</p>
</section><section id="question-4" class="level4"><h4 class="anchored" data-anchor-id="question-4">Question 4</h4>
<blockquote class="blockquote">
<p>I collect a set of data (<span class="math inline">\(n = 100\)</span> observations) containing a single predictor and a quantitative response. I then fit a linear regression model to the data, as well as a separate cubic regression, i.e.&nbsp;<span class="math inline">\(Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \epsilon\)</span>.</p>
</blockquote>
<blockquote class="blockquote">
<ol type="a">
<li>Suppose that the true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is linear, i.e.&nbsp;<span class="math inline">\(Y = \beta_0 + \beta_1X + \epsilon\)</span>. Consider the training residual sum of squares (RSS) for the linear regression, and also the training RSS for the cubic regression. Would we expect one to be lower than the other, would we expect them to be the same, or is there not enough information to tell? Justify your answer.</li>
</ol>
</blockquote>
<p>The more complex model will have a smaller <em>training</em> RSS because of the lower bias.</p>
<blockquote class="blockquote">
<ol start="2" type="a">
<li>Answer (a) using test rather than training RSS.</li>
</ol>
</blockquote>
<p>Given that the true model is actually linear, the more complex model will have a larger <em>testing</em> RSS because of the larger variance (overfitting).</p>
<blockquote class="blockquote">
<ol start="3" type="a">
<li>Suppose that the true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is not linear, but we don’t know how far it is from linear. Consider the training RSS for the linear regression, and also the training RSS for the cubic regression. Would we expect one to be lower than the other, would we expect them to be the same, or is there not enough information to tell? Justify your answer.</li>
</ol>
</blockquote>
<p>The further from linear the true model gets, the larger the <em>training</em> RSS will become for the linear model because of low flexibility and high bias.</p>
<blockquote class="blockquote">
<ol start="4" type="a">
<li>Answer (c) using test rather than training RSS.</li>
</ol>
</blockquote>
<p>Same as (c).</p>
</section><section id="question-5" class="level4"><h4 class="anchored" data-anchor-id="question-5">Question 5</h4>
<blockquote class="blockquote">
<p>Consider the fitted values that result from performing linear regression without an intercept. In this setting, the <span class="math inline">\(i\)</span>th fitted value takes the form <span class="math display">\[
\hat{y}_i = x_i\hat\beta
\]</span> where <span class="math display">\[
\hat{\beta} = \left(\sum_{i=1}^nx_iy_i\right) / \left(\sum_{i' = 1}^n x^2_{i'}\right).
\]</span> Show that we can write <span class="math display">\[
\hat{y}_i = \sum_{i' = 1}^na_{i'}y_{i'}
\]</span> What is <span class="math inline">\(a_{i'}\)</span>? <em>Note: We interpret this result by saying that the fitted values from linear regression are linear combinations of the response values.</em></p>
</blockquote>
<p><span class="math display">\[
\begin{align}
\hat{y}_i
  &amp; = x_i \frac{\sum_{i=1}^nx_iy_i}{\sum_{i' = 1}^n x^2_{i'}} \\
  &amp; = x_i \frac{\sum_{i'=1}^nx_{i'}y_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} \\
  &amp; = \frac{\sum_{i'=1}^n x_i x_{i'}y_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} \\
  &amp; = \sum_{i'=1}^n \frac{ x_i x_{i'}y_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} \\
  &amp; = \sum_{i'=1}^n \frac{ x_i x_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} y_{i'}
\end{align}
\]</span></p>
</section><section id="question-6" class="level4"><h4 class="anchored" data-anchor-id="question-6">Question 6</h4>
<blockquote class="blockquote">
<p>Using (3.4), argue that in the case of simple linear regression, the least squares line always passes through the point <span class="math inline">\((\bar{x}, \bar{y})\)</span>.</p>
</blockquote>
<p><span class="math display">\[
\begin{align}
\hat{y} &amp;= \hat\beta_0 + \hat\beta_1\bar{x} \\
  &amp;= (\bar{y} - \hat\beta_1\bar{x}) + \hat\beta_1\bar{x} \\
  &amp;= \bar{y}
\end{align}
\]</span></p>
</section><section id="question-7" class="level4"><h4 class="anchored" data-anchor-id="question-7">Question 7</h4>
<blockquote class="blockquote">
<p>It is claimed in the text that in the case of simple linear regression of <span class="math inline">\(Y\)</span> onto <span class="math inline">\(X\)</span>, the <span class="math inline">\(R^2\)</span> statistic (3.17) is equal to the square of the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (3.18). Prove that this is the case. For simplicity, you may assume that <span class="math inline">\(\bar{x} = \bar{y} = 0\)</span>.</p>
</blockquote>
<p>&lt; just algebra after making simplifying assumptions &gt;</p>
</section></section><section id="applied" class="level3" data-number="4.3.2"><h3 data-number="4.3.2" class="anchored" data-anchor-id="applied">
<span class="header-section-number">4.3.2</span> Applied</h3>
<section id="question-8" class="level4"><h4 class="anchored" data-anchor-id="question-8">Question 8</h4>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="va">data_car</span> <span class="op">&lt;-</span> <span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Auto.html">Auto</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">horsepower</span>, <span class="va">data_car</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit model</span></span>
<span><span class="va">mod_car</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">horsepower</span>, <span class="va">data_car</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">horsepower</span>, <span class="va">data_car</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">mod_car</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">mod_car</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 12
 $ coefficients : Named num [1:2] 39.936 -0.158
  ..- attr(*, "names")= chr [1:2] "(Intercept)" "horsepower"
 $ residuals    : Named num [1:392] -1.416 1.109 1.741 -0.259 -0.838 ...
  ..- attr(*, "names")= chr [1:392] "1" "2" "3" "4" ...
 $ effects      : Named num [1:392] -464.206 120.138 1.745 -0.255 -0.819 ...
  ..- attr(*, "names")= chr [1:392] "(Intercept)" "horsepower" "" "" ...
 $ rank         : int 2
 $ fitted.values: Named num [1:392] 19.4 13.9 16.3 16.3 17.8 ...
  ..- attr(*, "names")= chr [1:392] "1" "2" "3" "4" ...
 $ assign       : int [1:2] 0 1
 $ qr           :List of 5
  ..$ qr   : num [1:392, 1:2] -19.799 0.0505 0.0505 0.0505 0.0505 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. ..- attr(*, "assign")= int [1:2] 0 1
  ..$ qraux: num [1:2] 1.05 1.08
  ..$ pivot: int [1:2] 1 2
  ..$ tol  : num 0.0000001
  ..$ rank : int 2
  ..- attr(*, "class")= chr "qr"
 $ df.residual  : int 390
 $ xlevels      : Named list()
 $ call         : language lm(formula = mpg ~ horsepower, data = data_car)
 $ terms        :Classes 'terms', 'formula'  language mpg ~ horsepower
  .. ..- attr(*, "variables")= language list(mpg, horsepower)
  .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. ..- attr(*, "dimnames")=List of 2
  .. ..- attr(*, "term.labels")= chr "horsepower"
  .. ..- attr(*, "order")= int 1
  .. ..- attr(*, "intercept")= int 1
  .. ..- attr(*, "response")= int 1
  .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. ..- attr(*, "predvars")= language list(mpg, horsepower)
  .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
  .. .. ..- attr(*, "names")= chr [1:2] "mpg" "horsepower"
 $ model        :'data.frame':  392 obs. of  2 variables:
  ..$ mpg       : num [1:392] 18 15 18 16 17 15 14 14 14 15 ...
  ..$ horsepower: int [1:392] 130 165 150 150 140 198 220 215 225 190 ...
  ..- attr(*, "terms")=Classes 'terms', 'formula'  language mpg ~ horsepower
  .. .. ..- attr(*, "variables")= language list(mpg, horsepower)
  .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. ..- attr(*, "term.labels")= chr "horsepower"
  .. .. ..- attr(*, "order")= int 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(mpg, horsepower)
  .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
  .. .. .. ..- attr(*, "names")= chr [1:2] "mpg" "horsepower"
 - attr(*, "class")= chr "lm"</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get strength</span></span>
<span><span class="va">mod_car</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">r.squared</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6059483</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get coef</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod_car</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   39.9     0.717        55.7 1.22e-187
2 horsepower    -0.158   0.00645     -24.5 7.03e- 81</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># inference</span></span>
<span><span class="co"># -&gt; prediction of new obs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_car</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>horsepower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">98</span><span class="op">)</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"pred"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit     lwr      upr
1 24.46708 14.8094 34.12476</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_car</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>horsepower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">98</span><span class="op">)</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"conf"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 24.46708 23.97308 24.96108</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># diagnostic plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_car</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; nonlinearity and unequal variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="question-9" class="level4"><h4 class="anchored" data-anchor-id="question-9">Question 9</h4>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># scatterplot matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">data_car</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># correlation matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data_car</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    mpg  cylinders displacement horsepower     weight
mpg           1.0000000 -0.7776175   -0.8051269 -0.7784268 -0.8322442
cylinders    -0.7776175  1.0000000    0.9508233  0.8429834  0.8975273
displacement -0.8051269  0.9508233    1.0000000  0.8972570  0.9329944
horsepower   -0.7784268  0.8429834    0.8972570  1.0000000  0.8645377
weight       -0.8322442  0.8975273    0.9329944  0.8645377  1.0000000
acceleration  0.4233285 -0.5046834   -0.5438005 -0.6891955 -0.4168392
year          0.5805410 -0.3456474   -0.3698552 -0.4163615 -0.3091199
origin        0.5652088 -0.5689316   -0.6145351 -0.4551715 -0.5850054
             acceleration       year     origin
mpg             0.4233285  0.5805410  0.5652088
cylinders      -0.5046834 -0.3456474 -0.5689316
displacement   -0.5438005 -0.3698552 -0.6145351
horsepower     -0.6891955 -0.4163615 -0.4551715
weight         -0.4168392 -0.3091199 -0.5850054
acceleration    1.0000000  0.2903161  0.2127458
year            0.2903161  1.0000000  0.1815277
origin          0.2127458  0.1815277  1.0000000</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit model</span></span>
<span><span class="va">mod_car_mlr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">name</span>, data <span class="op">=</span> <span class="va">data_car</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_car_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ . - name, data = data_car, x = TRUE)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.5903 -2.1565 -0.1169  1.8690 13.0604 

Coefficients:
               Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  -17.218435   4.644294  -3.707              0.00024 ***
cylinders     -0.493376   0.323282  -1.526              0.12780    
displacement   0.019896   0.007515   2.647              0.00844 ** 
horsepower    -0.016951   0.013787  -1.230              0.21963    
weight        -0.006474   0.000652  -9.929 &lt; 0.0000000000000002 ***
acceleration   0.080576   0.098845   0.815              0.41548    
year           0.750773   0.050973  14.729 &lt; 0.0000000000000002 ***
origin         1.426141   0.278136   5.127          0.000000467 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.328 on 384 degrees of freedom
Multiple R-squared:  0.8215,    Adjusted R-squared:  0.8182 
F-statistic: 252.4 on 7 and 384 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># is a relationship between Y and the set of Xs</span></span>
<span><span class="co"># -&gt; displacement, weight, year and origin appear to be significant predictors</span></span>
<span><span class="co"># -&gt; hat(beta)_year &gt;  0 ==&gt; newer cars get better gas mileage</span></span>
<span></span>
<span><span class="co"># diagnostic plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_car_mlr</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; unequal variance</span></span>
<span></span>
<span><span class="co"># search for higher order effects</span></span>
<span></span>
<span><span class="co"># get residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod_car_mlr</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># plot against each X</span></span>
<span><span class="va">nms_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mod_car_mlr</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">map2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">mod_car_mlr</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">nms_x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span>, main <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-9.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-10.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$cylinders
NULL

$displacement
NULL

$horsepower
NULL

$weight
NULL

$acceleration
NULL

$year
NULL

$origin
NULL</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># if there is relationship of any kind, that indicates there is something more going on because we have controlled for the linear main effects</span></span>
<span><span class="co"># -&gt; something with displacement, horsepower, weight, and, year</span></span>
<span><span class="co"># -&gt; combined with the hereditary principle, these seem like good variables</span></span>
<span></span>
<span><span class="co"># try interaction effects</span></span>
<span><span class="va">mod_car_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">mod_car_mlr</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">displacement</span><span class="op">:</span><span class="va">weight</span> <span class="op">+</span> <span class="va">displacement</span><span class="op">:</span><span class="va">year</span> <span class="op">+</span> <span class="va">displacement</span><span class="op">:</span><span class="va">origin</span> <span class="op">+</span> <span class="va">weight</span><span class="op">:</span><span class="va">year</span> <span class="op">+</span> <span class="va">weight</span><span class="op">:</span><span class="va">origin</span> <span class="op">+</span> <span class="va">year</span><span class="op">:</span><span class="va">origin</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_car_int</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ cylinders + displacement + horsepower + weight + 
    acceleration + year + origin + displacement:weight + displacement:year + 
    displacement:origin + weight:year + weight:origin + year:origin, 
    data = data_car, x = TRUE)

Residuals:
   Min     1Q Median     3Q    Max 
-7.717 -1.608 -0.033  1.301 13.031 

Coefficients:
                         Estimate    Std. Error t value           Pr(&gt;|t|)    
(Intercept)         -41.805566419  24.906721073  -1.678           0.094079 .  
cylinders             0.452489261   0.304470575   1.486           0.138073    
displacement          0.080930869   0.082684765   0.979           0.328311    
horsepower           -0.044418845   0.012621585  -3.519           0.000485 ***
weight               -0.006558690   0.011117698  -0.590           0.555588    
acceleration          0.113084940   0.086916781   1.301           0.194027    
year                  1.279561152   0.323065989   3.961 0.0000893223144297 ***
origin               -1.670022247   5.242728051  -0.319           0.750251    
displacement:weight   0.000022021   0.000002833   7.772 0.0000000000000736 ***
displacement:year    -0.002170403   0.001144312  -1.897           0.058631 .  
displacement:origin   0.011891682   0.012453639   0.955           0.340251    
weight:year          -0.000055344   0.000150271  -0.368           0.712861    
weight:origin         0.000206268   0.000967806   0.213           0.831340    
year:origin           0.004978089   0.066417438   0.075           0.940293    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.856 on 378 degrees of freedom
Multiple R-squared:  0.8705,    Adjusted R-squared:  0.8661 
F-statistic: 195.5 on 13 and 378 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># only a couple of the interactions are significant</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_car_int</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-11.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-12.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod_car_int</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># plot against each X</span></span>
<span><span class="va">nms_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mod_car_int</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">map2</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">mod_car_int</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">nms_x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">nm</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span>, main <span class="op">=</span> <span class="va">nm</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lowess.html">lowess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">e</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-13.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-14.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-15.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-16.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-17.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-18.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-19.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-20.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-21.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-22.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-23.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-24.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-7-25.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$cylinders
NULL

$displacement
NULL

$horsepower
NULL

$weight
NULL

$acceleration
NULL

$year
NULL

$origin
NULL

$displacement.weight
NULL

$displacement.year
NULL

$displacement.origin
NULL

$weight.year
NULL

$weight.origin
NULL

$year.origin
NULL</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># now only unequal variance is left after controlling for interactions as well</span></span>
<span><span class="co"># -&gt; except for maybe year</span></span>
<span><span class="co"># -&gt; every function of year is significant</span></span>
<span><span class="va">mod_car_int2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">mod_car_int</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_car</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># see if significant</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_car_int2</span>, <span class="va">mod_car_int</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: mpg ~ cylinders + displacement + horsepower + weight + acceleration + 
    year + origin + sqrt(year) + displacement:weight + displacement:year + 
    displacement:origin + weight:year + weight:origin + year:origin
Model 2: mpg ~ cylinders + displacement + horsepower + weight + acceleration + 
    year + origin + displacement:weight + displacement:year + 
    displacement:origin + weight:year + weight:origin + year:origin
  Res.Df    RSS Df Sum of Sq     F     Pr(&gt;F)    
1    377 2927.9                                  
2    378 3083.5 -1   -155.63 20.04 0.00001006 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="question-10" class="level4"><h4 class="anchored" data-anchor-id="question-10">Question 10</h4>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="co"># -&gt; price = quan, urban and us = qual</span></span>
<span><span class="va">data_seats</span> <span class="op">&lt;-</span> <span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Carseats.html">Carseats</a></span></span>
<span></span>
<span><span class="co"># fit mlr model</span></span>
<span><span class="va">mod_seats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sales</span> <span class="op">~</span> <span class="va">Price</span> <span class="op">+</span> <span class="va">Urban</span> <span class="op">+</span> <span class="va">US</span>, data <span class="op">=</span> <span class="va">data_seats</span>, x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mod_seats</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  13.0      0.651     20.0    3.63e-62
2 Price        -0.0545   0.00524  -10.4    1.61e-22
3 UrbanYes     -0.0219   0.272     -0.0807 9.36e- 1
4 USYes         1.20     0.259      4.63   4.86e- 6</code></pre>
</div>
</div>
<p>Coefficient interpretations</p>
<p><span class="math inline">\(\hat{\beta}_0\)</span> = 13.043: For a non-urban store located outside of the US, we expect there to be 13,043 car seat sales on average.</p>
<p><span class="math inline">\(\hat{\beta}_{\text{Price}}\)</span> = -0.054: For each dollar increase in the price of the carseat, we expect the unit sales to decrease by approximately 54 units, on average.</p>
<p><span class="math inline">\(\hat{\beta}_{\text{UrbanYes}}\)</span> = -0.022: Stores located in urban areas have approximately 22 less sales on average than non-urban stores.</p>
<p><span class="math inline">\(\hat{\beta}_{\text{USYes}}\)</span> = 1.201: US stores have approximately 1201 more sales on average than non-US stores.</p>
<p>Written-out model</p>
<p><span class="math display">\[
\text{Sales} = \Bigg(\hat{\beta}_0 + \begin{cases}
   \hat{\beta}_{\text{UrbanYes}},     &amp; \text{if $\text{Urban}$ = Yes, $\text{US}$ = No} \\
    \hat{\beta}_{\text{USYes}},    &amp; \text{if $\text{Urban}$ = No, $\text{US}$ = Yes} \\
    \hat{\beta}_{\text{UrbanYes}} + \hat{\beta}_{\text{USYes}},    &amp; \text{if $\text{Urban}$ = $\text{US}$ = Yes} \\
    0,       &amp; \text{Otherwise}
\end{cases}\Bigg)
+ \hat{\beta}_{\text{Price}} \times \text{Price}
\]</span></p>
<p>which come out to be</p>
<p><span class="math display">\[
\text{Sales} = \Bigg(13 + \begin{cases}
   -0.022,   &amp; \text{if $\text{Urban}$ is Yes, $\text{US}$ is No} \\
    1.20,    &amp; \text{if $\text{Urban}$ is No, $\text{US}$ is Yes} \\
    1.18,    &amp; \text{if $\text{Urban}$ and $\text{US}$ is Yes} \\
    0,       &amp; \text{Otherwise}
\end{cases}
\Bigg)
- 0.054 \times \textit{Price}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># reject null for Price and US (not for Urban)</span></span>
<span></span>
<span><span class="co"># fit smaller model and test</span></span>
<span><span class="va">mod_seats2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">mod_seats</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">Urban</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_seats</span>, <span class="va">mod_seats2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Sales ~ Price + Urban + US
Model 2: Sales ~ Price + US
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1    396 2420.8                           
2    397 2420.9 -1  -0.03979 0.0065 0.9357</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; fail to reject --&gt; reduced model is better</span></span>
<span></span>
<span><span class="va">mod_seats</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">r.squared</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2392754</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod_seats2</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">r.squared</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2392629</code></pre>
</div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; just about the same fit</span></span>
<span></span>
<span><span class="co"># 95% confidence intervals for coefficients on reduced model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod_seats2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %      97.5 %
(Intercept) 11.79032020 14.27126531
Price       -0.06475984 -0.04419543
USYes        0.69151957  1.70776632</code></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># inspect for outliers / high leverage observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_seats2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; there are a few high leverage points, but they are not influential</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="question-11" class="level4"><h4 class="anchored" data-anchor-id="question-11">Question 11</h4>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit models without intercept</span></span>
<span><span class="va">mod_yx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_yx</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x + 0)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9154 -0.6472 -0.1771  0.5056  2.3109 

Coefficients:
  Estimate Std. Error t value            Pr(&gt;|t|)    
x   1.9939     0.1065   18.73 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9586 on 99 degrees of freedom
Multiple R-squared:  0.7798,    Adjusted R-squared:  0.7776 
F-statistic: 350.7 on 1 and 99 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_xy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = x ~ y + 0)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8699 -0.2368  0.1030  0.2858  0.8938 

Coefficients:
  Estimate Std. Error t value            Pr(&gt;|t|)    
y  0.39111    0.02089   18.73 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4246 on 99 degrees of freedom
Multiple R-squared:  0.7798,    Adjusted R-squared:  0.7776 
F-statistic: 350.7 on 1 and 99 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># results</span></span>
<span><span class="co"># -&gt; different estimates, same test-statistics</span></span>
<span><span class="co"># -&gt; this can be shown mathematically using the derived formulas for regression without an intercept</span></span>
<span></span>
<span><span class="co"># now with an intercept, show test statistics are the same for y ~ x and x ~ y</span></span>
<span><span class="va">mod_yx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="va">mod_yx</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.778         0.776 0.963      344. 7.72e-34     1  -137.  280.  288.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod_xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">mod_xy</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.778         0.776 0.425      344. 7.72e-34     1  -55.3  117.  124.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</section><section id="question-12" class="level4"><h4 class="anchored" data-anchor-id="question-12">Question 12</h4>
<p>Can show that estimates will be the same if swap <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> variables under a certain condition.</p>
<p><span class="math display">\[
Y \sim X: \hat\beta = \sum_i x_iy_i / \sum_{i'} x_{i'}^2
\]</span></p>
<p>The coefficient for the regression of X onto Y swaps the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables:</p>
<p><span class="math display">\[
X \sim Y: \hat\beta = \sum_i x_iy_i / \sum_{i'} y_{i'}^2
\]</span></p>
<p>So they are the same when <span class="math inline">\(\sum_{i} x_{i}^2 = \sum_{i} y_{i}^2\)</span></p>
</section><section id="question-13" class="level4"><h4 class="anchored" data-anchor-id="question-13">Question 13</h4>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># investigate coefficient confidence intervals based on the amount of noise</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># generate three response vecotrs with difference error variances</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">epsilon</span><span class="op">)</span> <span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="va">epsilon</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"original epsilon"</span>, <span class="st">"smaller epsilon"</span>, <span class="st">"larger epsilon"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit models based on same x</span></span>
<span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">%&gt;%</span> <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate coefficient confidence intervals</span></span>
<span><span class="va">mods</span> <span class="op">%&gt;%</span> <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`original epsilon`
        x 
0.4994698 

$`smaller epsilon`
        x 
0.5021167 

$`larger epsilon`
        x 
0.4443139 </code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mods</span> <span class="op">%&gt;%</span> <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`original epsilon`
                 2.5 %     97.5 %
(Intercept) -1.1150804 -0.9226122
x            0.3925794  0.6063602

$`smaller epsilon`
                 2.5 %     97.5 %
(Intercept) -1.0180413 -0.9764850
x            0.4790377  0.5251957

$`larger epsilon`
                 2.5 %     97.5 %
(Intercept) -1.1413399 -0.7433293
x            0.2232721  0.6653558</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># wider confidence intervals with more noise as expected, and more biased fits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="question-14" class="level4"><h4 class="anchored" data-anchor-id="question-14">Question 14</h4>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># generate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model is of the form:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \epsilon
\]</span></p>
<p>The coefficients are <span class="math inline">\(\beta_0 = 2\)</span>, <span class="math inline">\(\beta_1 = 2\)</span>, <span class="math inline">\(\beta_3 = 0.3\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># investigate relationship between x1 and x2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8351212</code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit model</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compare fitted coefficients to population values, then test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2 
   2.130500    1.439555    1.009674 </code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     2.13     0.232     9.19  7.61e-15
2 x1              1.44     0.721     2.00  4.87e- 2
3 x2              1.01     1.13      0.891 3.75e- 1</code></pre>
</div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fail to reject for x2</span></span>
<span></span>
<span><span class="co"># now fit models with the predictors individually</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     2.11     0.231      9.15 8.27e-15
2 x1              1.98     0.396      4.99 2.66e- 6</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     2.39     0.195     12.3  1.68e-21
2 x2              2.90     0.633      4.58 1.37e- 5</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># both reject</span></span>
<span><span class="co"># -&gt; this contradicts the mlr model where x2 was not significant</span></span>
<span></span>
<span><span class="co"># obtain new observations</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x2</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># refit models and see effect</span></span>
<span><span class="va">mod_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">mod1_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="va">mod2_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">mod_new</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    2.23      0.231     9.62  7.91e-16
2 x1             0.539     0.592     0.911 3.65e- 1
3 x2             2.51      0.898     2.80  6.14e- 3</code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod1_new</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     2.26     0.239      9.44 1.78e-15
2 x1              1.77     0.412      4.28 4.29e- 5</code></pre>
</div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod2_new</span> <span class="op">%&gt;%</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     2.35     0.191     12.3  1.40e-21
2 x2              3.12     0.604      5.16 1.25e- 6</code></pre>
</div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># seems similar results in the individual predictor models, however in the mlr model now both are significant -&gt; investigate why</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_new</span><span class="op">)</span> <span class="co"># high leverage with respect to x1 and x2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">6</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># outlier in y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">6</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># high leverage (i.e. outlier in x)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># useful to consider plot of the xs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="question-15" class="level4"><h4 class="anchored" data-anchor-id="question-15">Question 15</h4>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="va">data_boston</span> <span class="op">&lt;-</span> <span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span></span>
<span></span>
<span><span class="co"># fit many SLR models</span></span>
<span><span class="va">mods</span> <span class="op">&lt;-</span> <span class="va">data_boston</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">crim</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">data_boston</span><span class="op">$</span><span class="va">crim</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mods</span> <span class="op">%&gt;%</span> <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$zn
# A tibble: 1 × 2
  statistic    p.value
      &lt;dbl&gt;      &lt;dbl&gt;
1      21.1 0.00000551

$indus
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      99.8 1.45e-21

$chas
# A tibble: 1 × 2
  statistic p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1      1.58   0.209

$nox
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      109. 3.75e-23

$rm
# A tibble: 1 × 2
  statistic     p.value
      &lt;dbl&gt;       &lt;dbl&gt;
1      25.5 0.000000635

$age
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      71.6 2.85e-16

$dis
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      84.9 8.52e-19

$rad
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      324. 2.69e-56

$tax
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      259. 2.36e-47

$ptratio
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      46.3 2.94e-11

$lstat
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      132. 2.65e-27

$medv
# A tibble: 1 × 2
  statistic  p.value
      &lt;dbl&gt;    &lt;dbl&gt;
1      89.5 1.17e-19</code></pre>
</div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; all significant except chas</span></span>
<span></span>
<span><span class="co"># fit mlr model</span></span>
<span><span class="va">mod_mlr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span> <span class="va">crim</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_boston</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = crim ~ ., data = data_boston)

Residuals:
   Min     1Q Median     3Q    Max 
-8.534 -2.248 -0.348  1.087 73.923 

Coefficients:
              Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept) 13.7783938  7.0818258   1.946         0.052271 .  
zn           0.0457100  0.0187903   2.433         0.015344 *  
indus       -0.0583501  0.0836351  -0.698         0.485709    
chas        -0.8253776  1.1833963  -0.697         0.485841    
nox         -9.9575865  5.2898242  -1.882         0.060370 .  
rm           0.6289107  0.6070924   1.036         0.300738    
age         -0.0008483  0.0179482  -0.047         0.962323    
dis         -1.0122467  0.2824676  -3.584         0.000373 ***
rad          0.6124653  0.0875358   6.997 0.00000000000859 ***
tax         -0.0037756  0.0051723  -0.730         0.465757    
ptratio     -0.3040728  0.1863598  -1.632         0.103393    
lstat        0.1388006  0.0757213   1.833         0.067398 .  
medv        -0.2200564  0.0598240  -3.678         0.000261 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.46 on 493 degrees of freedom
Multiple R-squared:  0.4493,    Adjusted R-squared:  0.4359 
F-statistic: 33.52 on 12 and 493 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; can now only reject for zn, nox, dis, rad, lstat and medv</span></span>
<span></span>
<span><span class="co"># extract two sets of coefficients and plot against each other</span></span>
<span><span class="va">betas_slr</span> <span class="op">&lt;-</span> <span class="va">mods</span> <span class="op">%&gt;%</span> <span class="fu">map_dbl</span><span class="op">(</span>\<span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="va">as.numeric</span><span class="op">)</span></span>
<span><span class="va">betas_mlr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_mlr</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">betas_mlr</span> <span class="op">~</span> <span class="va">betas_slr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="islr-3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" data-fig-pos="hold" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The estimated coefficients differ (in particular the estimated coefficient for <code>nox</code> is dramatically different) between the two modelling strategies.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit many cubic models models</span></span>
<span><span class="va">mods_cubic</span> <span class="op">&lt;-</span> <span class="va">data_boston</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">crim</span>, <span class="va">chas</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">data_boston</span><span class="op">$</span><span class="va">crim</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mods_cubic</span> <span class="op">%&gt;%</span> <span class="fu">map</span><span class="op">(</span>\<span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$zn
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.372      9.71 1.55e-20
2 poly(x, 3)1   -38.7      8.37      -4.63 4.70e- 6
3 poly(x, 3)2    23.9      8.37       2.86 4.42e- 3
4 poly(x, 3)3   -10.1      8.37      -1.20 2.30e- 1

$indus
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.330     11.0  3.61e-25
2 poly(x, 3)1    78.6      7.42      10.6  8.85e-24
3 poly(x, 3)2   -24.4      7.42      -3.29 1.09e- 3
4 poly(x, 3)3   -54.1      7.42      -7.29 1.20e-12

$nox
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.322     11.2  2.74e-26
2 poly(x, 3)1    81.4      7.23      11.2  2.46e-26
3 poly(x, 3)2   -28.8      7.23      -3.99 7.74e- 5
4 poly(x, 3)3   -60.4      7.23      -8.34 6.96e-16

$rm
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.370     9.76  1.03e-20
2 poly(x, 3)1   -42.4      8.33     -5.09  5.13e- 7
3 poly(x, 3)2    26.6      8.33      3.19  1.51e- 3
4 poly(x, 3)3    -5.51     8.33     -0.662 5.09e- 1

$age
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.349     10.4  5.92e-23
2 poly(x, 3)1    68.2      7.84       8.70 4.88e-17
3 poly(x, 3)2    37.5      7.84       4.78 2.29e- 6
4 poly(x, 3)3    21.4      7.84       2.72 6.68e- 3

$dis
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.326     11.1  1.06e-25
2 poly(x, 3)1   -73.4      7.33     -10.0  1.25e-21
3 poly(x, 3)2    56.4      7.33       7.69 7.87e-14
4 poly(x, 3)3   -42.6      7.33      -5.81 1.09e- 8

$rad
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.297    12.2   5.15e-30
2 poly(x, 3)1   121.       6.68     18.1   1.05e-56
3 poly(x, 3)2    17.5      6.68      2.62  9.12e- 3
4 poly(x, 3)3     4.70     6.68      0.703 4.82e- 1

$tax
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.305     11.9  8.96e-29
2 poly(x, 3)1   113.       6.85      16.4  6.98e-49
3 poly(x, 3)2    32.1      6.85       4.68 3.67e- 6
4 poly(x, 3)3    -8.00     6.85      -1.17 2.44e- 1

$ptratio
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.361     10.0  1.27e-21
2 poly(x, 3)1    56.0      8.12       6.90 1.57e-11
3 poly(x, 3)2    24.8      8.12       3.05 2.41e- 3
4 poly(x, 3)3   -22.3      8.12      -2.74 6.30e- 3

$lstat
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.339     10.7  4.94e-24
2 poly(x, 3)1    88.1      7.63      11.5  1.68e-27
3 poly(x, 3)2    15.9      7.63       2.08 3.78e- 2
4 poly(x, 3)3   -11.6      7.63      -1.52 1.30e- 1

$medv
# A tibble: 4 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     3.61     0.292     12.4  7.02e-31
2 poly(x, 3)1   -75.1      6.57     -11.4  4.93e-27
3 poly(x, 3)2    88.1      6.57      13.4  2.93e-35
4 poly(x, 3)3   -48.0      6.57      -7.31 1.05e-12</code></pre>
</div>
</div>
<p>Several models have a significant cubic term, if not then the quadratic term is significant for the rest.</p>


<!-- -->

</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./islr-2.html" class="pagination-link" aria-label="Statistical learning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Statistical learning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./islr-4.html" class="pagination-link" aria-label="Classification">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Classification</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb90" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear regression</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-prereqs</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr options</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Notes</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple linear regression</span></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">https://coltongearhart.github.io/regression/notes-slr.html</span><span class="co">](https://coltongearhart.github.io/regression/notes-slr.html)</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multiple linear regression</span></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">https://coltongearhart.github.io/regression/notes-multiple-regression-1.html</span><span class="co">](https://coltongearhart.github.io/regression/notes-multiple-regression-1.html)</span> and <span class="co">[</span><span class="ot">https://coltongearhart.github.io/regression/notes-multiple-regression-2.html</span><span class="co">](https://coltongearhart.github.io/regression/notes-multiple-regression-2.html)</span></span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other considerations in the regression model</span></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">https://coltongearhart.github.io/regression/notes-reg-models-quan-and-qual.html</span><span class="co">](https://coltongearhart.github.io/regression/notes-reg-models-quan-and-qual.html)</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>Things to study more from other text</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Leverage</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>VIF</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison of linear regression with $K$-nearest neighbors</span></span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>As discussed earlier, *non-parametric* methods do not explicitly assume a parametric form for $f(X)$, and thereby provide an alternative and more flexible approach for performing regression. Here we consider one of the simplest and best-known non-parametric methods,*$K$-nearest neighbors regression * (KNN regression). The KNN regression method is closely related to the KNN classifier discussed in the previous chapter. **Given a value for $K$ and a prediction point $x_0$, KNN regression first identifies the $K$ training observations that are closest to $x_0$, represented by $\cal{N}_0$. It then estimates $f(x_0)$ using the average of all the training responses in $\cal{N}_0$**. In other words,</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a>\hat{f}(x_0) = \frac{1}{K}\sum_{x_i \in \cal{N}_0} y_i</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/3-knn-regression.png)</span>{width="50%"}</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>We see that when $K = 1$, the KNN fit perfectly interpolates the training observations, and consequently takes the form of a step function. When $K = 9$, the KNN fit still is a step function, but averaging over nine observations results in much smaller regions of constant prediction, and consequently a smoother fit. **In general, the optimal value for K will depend on the bias-variance tradeoff**.</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>A small value for $K$ provides the most flexible fit, which will have low bias but high variance. This variance is due to the fact that the prediction in a given region is entirely dependent on just one observation. In contrast, larger values of $K$ provide a smoother and less variable fit; the prediction in a region is an average of several points, and so changing one observation has a smaller effect. However, the smoothing may cause bias by masking some of the structure in $f(X)$.</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>In what setting will a parametric approach such as least squares linear regression outperform a non-parametric approach such as KNN regression? The answer is simple: **the parametric approach will outperform the non- parametric approach if the parametric form that has been selected is close to the true form of $f$.**</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/3-knn-comparison.png)</span>{width="50%"}</span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a>Figure 3.17 provides an example with data generated from a one-dimensional linear regression model. The black solid lines represent $f(X)$, while the blue curves correspond to the KNN fits using $K = 1$ and $K = 9$. In this case, the $K = 1$ predictions are far too variable, while the smoother $K = 9$ fit is much closer to $f(X)$. **However, since the true relationship is linear, it is hard for a non-parametric approach to compete with linear regression: a non-parametric approach incurs a cost in variance that is not offset by a reduction in bias.*</span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/3-knn-comparison-3.png)</span>{width="50%"}</span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>Figure 3.19 examines the relative performances of least squares regression and KNN under increasing levels of non-linearity in the relationship between $X$ and $Y$. In more non-linear situation, KNN substantially outperforms linear regression for all values of $K$. **Note that as the extent of non-linearity increases, there is little change in the test set MSE for the non-parametric KNN method, but there is a large increase in the test set MSE of linear regression.**</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a>In a real life situation in which the true relationship is unknown, one might suspect that KNN should be favored over linear regression because it will at worst be slightly inferior to linear regression if the true relationship is linear, and may give substantially better results if the true relationship is non-linear. But in reality, even when the true relationship is highly non-linear, KNN may still provide inferior results to linear regression. **But in higher dimensions, KNN often performs worse than linear regression.**</span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a><span class="al">![](files/images/3-knn-comparison-4.png)</span>{width="50%"}</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>Figure 3.20 considers the same strongly non-linear situation as in the</span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>second row of Figure 3.19, except that we have added additional *noise*</span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>predictors that are not associated with the response. But for $p = 3$ the results are mixed, and for $p \ge 4$ linear regression is superior to KNN. In fact, the increase in dimension has only caused a small deterioration in the linear regression test set MSE, but it has caused more than a ten-fold increase in the MSE for KNN. **This decrease in performance as the dimension increases is a common problem for KNN, and results from the fact that in higher dimensions there is effectively a reduction in sample size**. In this data set there are 50 training observations; when $p = 1$, this provides enough information to accurately estimate $f(X)$. However, spreading 50 observations over $p = 20$ dimensions results in a phenomenon in which a given observation has *no nearby neighbors* -- this is the so-called *curse of dimensionality*.</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>**As a general rule, parametric methods will tend to outperform non-parametric approaches when there is a small number of observations per predictor. Even when the dimension is small, we might prefer linear regression to KNN from an interpretability standpoint. If the test MSE of KNN is only slightly lower than that of linear regression, we might be willing to forego a little bit of prediction accuracy for the sake of a simple model that can be described in terms of just a few coefficients, and for which p-values are available.**</span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab</span></span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a>&lt; just basic regression commands &gt;</span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a>Some key points</span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`hatvalues(&lt; mod &gt;)`</span>: Computes the hat values for each observation.</span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-77"><a href="#cb90-77" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Then can run <span class="in">`hatvalues(&lt; mod &gt;) %&gt;% which.max`</span> to get the largest one.</span>
<span id="cb90-78"><a href="#cb90-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`car::vif()`</span>: Computes the VIF for each predictor.</span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In the formula, <span class="in">`poly()`</span> by default orthogonalizes the predictors, so they are not simply a sequence of higher powers of the argument.</span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a><span class="ss">    -  </span>However, a linear model applied to the output of the <span class="in">`poly()`</span> function will have the same fitted values as a linear model applied to the raw polynomials (<span class="in">`raw = TRUE`</span>; although the coefficient estimates, standard errors, and p-values will differ).</span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`contrasts(&lt; factor &gt;)`</span>: Returns the coding that R uses for the dummy variables.</span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conceptual</span></span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 1</span></span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-93"><a href="#cb90-93" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Describe the null hypotheses to which the p-values shown below correspond. Explain what conclusions you can draw based on these p-values. Your explanation should be phrased in terms of the predictors, rather than in terms of the coefficients of the linear model.</span></span>
<span id="cb90-94"><a href="#cb90-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-97"><a href="#cb90-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-98"><a href="#cb90-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb90-99"><a href="#cb90-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-100"><a href="#cb90-100" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Sepal.Width <span class="sc">~</span> Petal.Width <span class="sc">+</span> Petal.Length <span class="sc">+</span> Sepal.Length, <span class="at">data =</span> iris) <span class="sc">%&gt;%</span> </span>
<span id="cb90-101"><a href="#cb90-101" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-102"><a href="#cb90-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-103"><a href="#cb90-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-104"><a href="#cb90-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-105"><a href="#cb90-105" aria-hidden="true" tabindex="-1"></a>For <span class="in">`Petal.Length`</span>:</span>
<span id="cb90-106"><a href="#cb90-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-107"><a href="#cb90-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-108"><a href="#cb90-108" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb90-109"><a href="#cb90-109" aria-hidden="true" tabindex="-1"></a>H_0&amp;: \beta_{\text{Petal.Length}} = 0 <span class="sc">\\</span></span>
<span id="cb90-110"><a href="#cb90-110" aria-hidden="true" tabindex="-1"></a>H_A&amp;: \beta_{\text{Petal.Length}} \ne 0</span>
<span id="cb90-111"><a href="#cb90-111" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb90-112"><a href="#cb90-112" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-113"><a href="#cb90-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-116"><a href="#cb90-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-117"><a href="#cb90-117" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb90-118"><a href="#cb90-118" aria-hidden="true" tabindex="-1"></a>mod_iris <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Width <span class="sc">~</span> Petal.Width <span class="sc">+</span> Petal.Length <span class="sc">+</span> Sepal.Length, <span class="at">data =</span> iris, <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-119"><a href="#cb90-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-120"><a href="#cb90-120" aria-hidden="true" tabindex="-1"></a><span class="co"># verify p-value</span></span>
<span id="cb90-121"><a href="#cb90-121" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod_iris)[<span class="st">"Petal.Length"</span>]</span>
<span id="cb90-122"><a href="#cb90-122" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> mod_iris<span class="sc">$</span>x</span>
<span id="cb90-123"><a href="#cb90-123" aria-hidden="true" tabindex="-1"></a>se_beta_hats <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod_iris)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> (X))</span>
<span id="cb90-124"><a href="#cb90-124" aria-hidden="true" tabindex="-1"></a>se_beta_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(se_beta_hats[<span class="dv">3</span>,<span class="dv">3</span>])</span>
<span id="cb90-125"><a href="#cb90-125" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="at">q =</span> beta_hat <span class="sc">/</span> se_beta_hat, <span class="at">df =</span> <span class="fu">nobs</span>(mod_iris) <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mod_iris)), <span class="at">lower.tail =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">%&gt;%</span> as.numeric</span>
<span id="cb90-126"><a href="#cb90-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-127"><a href="#cb90-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-128"><a href="#cb90-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-129"><a href="#cb90-129" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 2</span></span>
<span id="cb90-130"><a href="#cb90-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-131"><a href="#cb90-131" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Carefully explain the differences between the KNN classifier and KNN regression methods.</span></span>
<span id="cb90-132"><a href="#cb90-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-133"><a href="#cb90-133" aria-hidden="true" tabindex="-1"></a>Simply stated, The KNN classifier is categorical and assigns a value based on the most frequent observed category among $K$ nearest neighbors, whereas KNN regression assigns a continuous variable, the average of the response variables for the $K$ nearest neighbors. This represents two different summary functions, which are: for classification</span>
<span id="cb90-134"><a href="#cb90-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-135"><a href="#cb90-135" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-136"><a href="#cb90-136" aria-hidden="true" tabindex="-1"></a>\hat{f}(x_0) = \text{max}_j\bigg\{\frac{1}{K}\sum_{x_i \in \cal{N}_0} I(y_i = j)\bigg<span class="sc">\}</span></span>
<span id="cb90-137"><a href="#cb90-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-138"><a href="#cb90-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-139"><a href="#cb90-139" aria-hidden="true" tabindex="-1"></a>and for regression</span>
<span id="cb90-140"><a href="#cb90-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-141"><a href="#cb90-141" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-142"><a href="#cb90-142" aria-hidden="true" tabindex="-1"></a>\hat{f}(x_0) = \frac{1}{K}\sum_{x_i \in \cal{N}_0} y_i</span>
<span id="cb90-143"><a href="#cb90-143" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-144"><a href="#cb90-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-145"><a href="#cb90-145" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 3</span></span>
<span id="cb90-146"><a href="#cb90-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-147"><a href="#cb90-147" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Suppose we have a data set with five predictors, $X_1$ = GPA, $X_2$ = IQ, $X_3$ = Level (1 for College and 0 for High School), $X_4$ = Interaction between GPA and IQ, and $X_5$ = Interaction between GPA and Level. The response is starting salary after graduation (in thousands of dollars). Suppose we use least squares to fit the model, and get $\hat\beta_0 = 50$, $\hat\beta_1 = 20$, $\hat\beta_2 = 0.07$, $\hat\beta_3 = 35$, $\hat\beta_4 = 0.01$, $\hat\beta_5 = -10$.</span></span>
<span id="cb90-148"><a href="#cb90-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-149"><a href="#cb90-149" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; a. Which answer is correct, and why?</span></span>
<span id="cb90-150"><a href="#cb90-150" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;      i. For a fixed value of IQ and GPA, high school graduates earn more on average than college graduates.</span></span>
<span id="cb90-151"><a href="#cb90-151" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     ii. For a fixed value of IQ and GPA, college graduates earn more on average than high school graduates.</span></span>
<span id="cb90-152"><a href="#cb90-152" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     iii. For a fixed value of IQ and GPA, high school graduates earn more on average than college graduates provided that the GPA is high enough.</span></span>
<span id="cb90-153"><a href="#cb90-153" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;     iv. For a fixed value of IQ and GPA, college graduates earn more on average than high school graduates provided that the GPA is high enough.</span></span>
<span id="cb90-154"><a href="#cb90-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-155"><a href="#cb90-155" aria-hidden="true" tabindex="-1"></a>i. False: $\hat{\beta}_3 &gt; 0$</span>
<span id="cb90-156"><a href="#cb90-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-157"><a href="#cb90-157" aria-hidden="true" tabindex="-1"></a>ii. False: Have to take into account the interactions</span>
<span id="cb90-158"><a href="#cb90-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-159"><a href="#cb90-159" aria-hidden="true" tabindex="-1"></a>iii. True: $\hat{\beta}_5 = -10$, which means the slope for GPA decreases by 10 for college students. So for large enough GPAs, high school plane surpasses that of college</span>
<span id="cb90-160"><a href="#cb90-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-161"><a href="#cb90-161" aria-hidden="true" tabindex="-1"></a>iv. False: above reason</span>
<span id="cb90-162"><a href="#cb90-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-165"><a href="#cb90-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-166"><a href="#cb90-166" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted response curve</span></span>
<span id="cb90-167"><a href="#cb90-167" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(gpa, iq, level) {</span>
<span id="cb90-168"><a href="#cb90-168" aria-hidden="true" tabindex="-1"></a>  <span class="dv">50</span> <span class="sc">+</span></span>
<span id="cb90-169"><a href="#cb90-169" aria-hidden="true" tabindex="-1"></a>  gpa <span class="sc">*</span> <span class="dv">20</span> <span class="sc">+</span></span>
<span id="cb90-170"><a href="#cb90-170" aria-hidden="true" tabindex="-1"></a>  iq <span class="sc">*</span> <span class="fl">0.07</span> <span class="sc">+</span></span>
<span id="cb90-171"><a href="#cb90-171" aria-hidden="true" tabindex="-1"></a>  level <span class="sc">*</span> <span class="dv">35</span> <span class="sc">+</span></span>
<span id="cb90-172"><a href="#cb90-172" aria-hidden="true" tabindex="-1"></a>  gpa <span class="sc">*</span> iq <span class="sc">*</span> <span class="fl">0.01</span> <span class="sc">+</span></span>
<span id="cb90-173"><a href="#cb90-173" aria-hidden="true" tabindex="-1"></a>  gpa <span class="sc">*</span> level <span class="sc">*</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb90-174"><a href="#cb90-174" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-175"><a href="#cb90-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-176"><a href="#cb90-176" aria-hidden="true" tabindex="-1"></a><span class="co"># set predictors</span></span>
<span id="cb90-177"><a href="#cb90-177" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb90-178"><a href="#cb90-178" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">200</span>, <span class="at">length =</span> <span class="dv">20</span>)</span>
<span id="cb90-179"><a href="#cb90-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-180"><a href="#cb90-180" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate response</span></span>
<span id="cb90-181"><a href="#cb90-181" aria-hidden="true" tabindex="-1"></a>college <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, <span class="at">FUN =</span> model, <span class="at">level =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> t</span>
<span id="cb90-182"><a href="#cb90-182" aria-hidden="true" tabindex="-1"></a>high_school <span class="ot">&lt;-</span> <span class="fu">outer</span>(x, y, <span class="at">FUN =</span> model, <span class="at">level =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> t</span>
<span id="cb90-183"><a href="#cb90-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-184"><a href="#cb90-184" aria-hidden="true" tabindex="-1"></a><span class="co"># plot surfaces</span></span>
<span id="cb90-185"><a href="#cb90-185" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) <span class="sc">%&gt;%</span> </span>
<span id="cb90-186"><a href="#cb90-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_surface</span>(</span>
<span id="cb90-187"><a href="#cb90-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>college,</span>
<span id="cb90-188"><a href="#cb90-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"rgb(107,184,214)"</span>, <span class="st">"rgb(0,90,124)"</span>)),</span>
<span id="cb90-189"><a href="#cb90-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"College"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-190"><a href="#cb90-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_surface</span>(</span>
<span id="cb90-191"><a href="#cb90-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>high_school,</span>
<span id="cb90-192"><a href="#cb90-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">"rgb(255,112,184)"</span>, <span class="st">"rgb(128,0,64)"</span>)),</span>
<span id="cb90-193"><a href="#cb90-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"High school"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-194"><a href="#cb90-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb90-195"><a href="#cb90-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"GPA"</span>),</span>
<span id="cb90-196"><a href="#cb90-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"IQ"</span>),</span>
<span id="cb90-197"><a href="#cb90-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Salary"</span>)))</span>
<span id="cb90-198"><a href="#cb90-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-199"><a href="#cb90-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-200"><a href="#cb90-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-201"><a href="#cb90-201" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; b. Predict the salary of a college graduate with IQ of 110 and a GPA of 4.0.</span></span>
<span id="cb90-202"><a href="#cb90-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-205"><a href="#cb90-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-206"><a href="#cb90-206" aria-hidden="true" tabindex="-1"></a><span class="fu">model</span>(<span class="at">gpa =</span> <span class="dv">4</span>, <span class="at">iq =</span> <span class="dv">110</span>, <span class="at">level =</span> <span class="dv">1</span>)</span>
<span id="cb90-207"><a href="#cb90-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-208"><a href="#cb90-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-209"><a href="#cb90-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-210"><a href="#cb90-210" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; c. True or false: Since the coefficient for the GPA/IQ interaction term is very small, there is very little evidence of an interaction effect. Justify your answer.</span></span>
<span id="cb90-211"><a href="#cb90-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-212"><a href="#cb90-212" aria-hidden="true" tabindex="-1"></a>False. Scale is based on units, need information about the significance.</span>
<span id="cb90-213"><a href="#cb90-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-214"><a href="#cb90-214" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 4</span></span>
<span id="cb90-215"><a href="#cb90-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-216"><a href="#cb90-216" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; I collect a set of data ($n = 100$ observations) containing a single predictor and a quantitative response. I then fit a linear regression model to the data, as well as a separate cubic regression, i.e. $Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \epsilon$.</span></span>
<span id="cb90-217"><a href="#cb90-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-218"><a href="#cb90-218" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; a. Suppose that the true relationship between $X$ and $Y$ is linear, i.e. $Y = \beta_0 + \beta_1X + \epsilon$. Consider the training residual sum of squares (RSS) for the linear regression, and also the training RSS for the cubic regression. Would we expect one to be lower than the other, would we expect them to be the same, or is there not enough information to tell? Justify your answer.</span></span>
<span id="cb90-219"><a href="#cb90-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-220"><a href="#cb90-220" aria-hidden="true" tabindex="-1"></a>The more complex model will have a smaller *training* RSS because of the lower bias.</span>
<span id="cb90-221"><a href="#cb90-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-222"><a href="#cb90-222" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (b) Answer (a) using test rather than training RSS.</span></span>
<span id="cb90-223"><a href="#cb90-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-224"><a href="#cb90-224" aria-hidden="true" tabindex="-1"></a>Given that the true model is actually linear, the more complex model will have a larger *testing* RSS because of the larger variance (overfitting).</span>
<span id="cb90-225"><a href="#cb90-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-226"><a href="#cb90-226" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (c) Suppose that the true relationship between $X$ and $Y$ is not linear, but we don’t know how far it is from linear. Consider the training RSS for the linear regression, and also the training RSS for the cubic regression. Would we expect one to be lower than the other, would we expect them to be the same, or is there not enough information to tell? Justify your answer.</span></span>
<span id="cb90-227"><a href="#cb90-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-228"><a href="#cb90-228" aria-hidden="true" tabindex="-1"></a>The further from linear the true model gets, the larger the *training* RSS will become for the linear model because of low flexibility and high bias.</span>
<span id="cb90-229"><a href="#cb90-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-230"><a href="#cb90-230" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (d) Answer (c) using test rather than training RSS.</span></span>
<span id="cb90-231"><a href="#cb90-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-232"><a href="#cb90-232" aria-hidden="true" tabindex="-1"></a>Same as (c).</span>
<span id="cb90-233"><a href="#cb90-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-234"><a href="#cb90-234" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 5 </span></span>
<span id="cb90-235"><a href="#cb90-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-236"><a href="#cb90-236" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Consider the fitted values that result from performing linear regression without an intercept. In this setting, the $i$th fitted value takes the form </span></span>
<span id="cb90-237"><a href="#cb90-237" aria-hidden="true" tabindex="-1"></a><span class="at">$$</span></span>
<span id="cb90-238"><a href="#cb90-238" aria-hidden="true" tabindex="-1"></a><span class="at">\hat{y}_i = x_i\hat\beta</span></span>
<span id="cb90-239"><a href="#cb90-239" aria-hidden="true" tabindex="-1"></a><span class="at">$$</span></span>
<span id="cb90-240"><a href="#cb90-240" aria-hidden="true" tabindex="-1"></a><span class="at">where</span></span>
<span id="cb90-241"><a href="#cb90-241" aria-hidden="true" tabindex="-1"></a><span class="at">$$</span></span>
<span id="cb90-242"><a href="#cb90-242" aria-hidden="true" tabindex="-1"></a><span class="at">\hat{\beta} = \left(\sum_{i=1}^nx_iy_i\right) / \left(\sum_{i' = 1}^n x^2_{i'}\right).</span></span>
<span id="cb90-243"><a href="#cb90-243" aria-hidden="true" tabindex="-1"></a><span class="at">$$</span></span>
<span id="cb90-244"><a href="#cb90-244" aria-hidden="true" tabindex="-1"></a><span class="at">Show that we can write</span></span>
<span id="cb90-245"><a href="#cb90-245" aria-hidden="true" tabindex="-1"></a><span class="at">$$</span></span>
<span id="cb90-246"><a href="#cb90-246" aria-hidden="true" tabindex="-1"></a><span class="at">\hat{y}_i = \sum_{i' = 1}^na_{i'}y_{i'}</span></span>
<span id="cb90-247"><a href="#cb90-247" aria-hidden="true" tabindex="-1"></a><span class="at">$$</span></span>
<span id="cb90-248"><a href="#cb90-248" aria-hidden="true" tabindex="-1"></a><span class="at">What is $a_{i'}$?</span></span>
<span id="cb90-249"><a href="#cb90-249" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Note: We interpret this result by saying that the fitted values from linear regression are linear combinations of the response values.*</span></span>
<span id="cb90-250"><a href="#cb90-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-251"><a href="#cb90-251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-252"><a href="#cb90-252" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb90-253"><a href="#cb90-253" aria-hidden="true" tabindex="-1"></a>\hat{y}_i </span>
<span id="cb90-254"><a href="#cb90-254" aria-hidden="true" tabindex="-1"></a>  &amp; = x_i \frac{\sum_{i=1}^nx_iy_i}{\sum_{i' = 1}^n x^2_{i'}} <span class="sc">\\</span></span>
<span id="cb90-255"><a href="#cb90-255" aria-hidden="true" tabindex="-1"></a>  &amp; = x_i \frac{\sum_{i'=1}^nx_{i'}y_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} <span class="sc">\\</span></span>
<span id="cb90-256"><a href="#cb90-256" aria-hidden="true" tabindex="-1"></a>  &amp; = \frac{\sum_{i'=1}^n x_i x_{i'}y_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} <span class="sc">\\</span></span>
<span id="cb90-257"><a href="#cb90-257" aria-hidden="true" tabindex="-1"></a>  &amp; = \sum_{i'=1}^n \frac{ x_i x_{i'}y_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} <span class="sc">\\</span></span>
<span id="cb90-258"><a href="#cb90-258" aria-hidden="true" tabindex="-1"></a>  &amp; = \sum_{i'=1}^n \frac{ x_i x_{i'}}{\sum_{i'' = 1}^n x^2_{i''}} y_{i'}</span>
<span id="cb90-259"><a href="#cb90-259" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb90-260"><a href="#cb90-260" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-261"><a href="#cb90-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-262"><a href="#cb90-262" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 6</span></span>
<span id="cb90-263"><a href="#cb90-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-264"><a href="#cb90-264" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Using (3.4), argue that in the case of simple linear regression, the least squares line always passes through the point $(\bar{x}, \bar{y})$.</span></span>
<span id="cb90-265"><a href="#cb90-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-266"><a href="#cb90-266" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-267"><a href="#cb90-267" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb90-268"><a href="#cb90-268" aria-hidden="true" tabindex="-1"></a>\hat{y} &amp;= \hat\beta_0 + \hat\beta_1\bar{x} <span class="sc">\\</span></span>
<span id="cb90-269"><a href="#cb90-269" aria-hidden="true" tabindex="-1"></a>  &amp;= (\bar{y} - \hat\beta_1\bar{x}) + \hat\beta_1\bar{x} <span class="sc">\\</span></span>
<span id="cb90-270"><a href="#cb90-270" aria-hidden="true" tabindex="-1"></a>  &amp;= \bar{y}</span>
<span id="cb90-271"><a href="#cb90-271" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb90-272"><a href="#cb90-272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-273"><a href="#cb90-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-274"><a href="#cb90-274" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 7</span></span>
<span id="cb90-275"><a href="#cb90-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-276"><a href="#cb90-276" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; It is claimed in the text that in the case of simple linear regression of $Y$ onto $X$, the $R^2$ statistic (3.17) is equal to the square of the correlation between $X$ and $Y$ (3.18). Prove that this is the case. For simplicity, you may assume that $\bar{x} = \bar{y} = 0$.</span></span>
<span id="cb90-277"><a href="#cb90-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-278"><a href="#cb90-278" aria-hidden="true" tabindex="-1"></a>&lt; just algebra after making simplifying assumptions &gt;</span>
<span id="cb90-279"><a href="#cb90-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-280"><a href="#cb90-280" aria-hidden="true" tabindex="-1"></a><span class="fu">### Applied</span></span>
<span id="cb90-281"><a href="#cb90-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-282"><a href="#cb90-282" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 8</span></span>
<span id="cb90-283"><a href="#cb90-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-286"><a href="#cb90-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-287"><a href="#cb90-287" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data</span></span>
<span id="cb90-288"><a href="#cb90-288" aria-hidden="true" tabindex="-1"></a>data_car <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Auto</span>
<span id="cb90-289"><a href="#cb90-289" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> horsepower, data_car)</span>
<span id="cb90-290"><a href="#cb90-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-291"><a href="#cb90-291" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb90-292"><a href="#cb90-292" aria-hidden="true" tabindex="-1"></a>mod_car <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, data_car)</span>
<span id="cb90-293"><a href="#cb90-293" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg <span class="sc">~</span> horsepower, data_car)</span>
<span id="cb90-294"><a href="#cb90-294" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod_car, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb90-295"><a href="#cb90-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-296"><a href="#cb90-296" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mod_car)</span>
<span id="cb90-297"><a href="#cb90-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-298"><a href="#cb90-298" aria-hidden="true" tabindex="-1"></a><span class="co"># get strength</span></span>
<span id="cb90-299"><a href="#cb90-299" aria-hidden="true" tabindex="-1"></a>mod_car <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(r.squared)</span>
<span id="cb90-300"><a href="#cb90-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-301"><a href="#cb90-301" aria-hidden="true" tabindex="-1"></a><span class="co"># get coef</span></span>
<span id="cb90-302"><a href="#cb90-302" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(mod_car)</span>
<span id="cb90-303"><a href="#cb90-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-304"><a href="#cb90-304" aria-hidden="true" tabindex="-1"></a><span class="co"># inference</span></span>
<span id="cb90-305"><a href="#cb90-305" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; prediction of new obs</span></span>
<span id="cb90-306"><a href="#cb90-306" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_car, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">horsepower =</span> <span class="fu">c</span>(<span class="dv">98</span>)), <span class="at">interval =</span> <span class="st">"pred"</span>)</span>
<span id="cb90-307"><a href="#cb90-307" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_car, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">horsepower =</span> <span class="fu">c</span>(<span class="dv">98</span>)), <span class="at">interval =</span> <span class="st">"conf"</span>)</span>
<span id="cb90-308"><a href="#cb90-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-309"><a href="#cb90-309" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plots</span></span>
<span id="cb90-310"><a href="#cb90-310" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_car, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb90-311"><a href="#cb90-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-312"><a href="#cb90-312" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; nonlinearity and unequal variance</span></span>
<span id="cb90-313"><a href="#cb90-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-314"><a href="#cb90-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-315"><a href="#cb90-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-316"><a href="#cb90-316" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 9</span></span>
<span id="cb90-317"><a href="#cb90-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-320"><a href="#cb90-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-321"><a href="#cb90-321" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot matrix</span></span>
<span id="cb90-322"><a href="#cb90-322" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(data_car)</span>
<span id="cb90-323"><a href="#cb90-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-324"><a href="#cb90-324" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix</span></span>
<span id="cb90-325"><a href="#cb90-325" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data_car[, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb90-326"><a href="#cb90-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-327"><a href="#cb90-327" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb90-328"><a href="#cb90-328" aria-hidden="true" tabindex="-1"></a>mod_car_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> . <span class="sc">-</span> name, <span class="at">data =</span> data_car, <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-329"><a href="#cb90-329" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_car_mlr)</span>
<span id="cb90-330"><a href="#cb90-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-331"><a href="#cb90-331" aria-hidden="true" tabindex="-1"></a><span class="co"># is a relationship between Y and the set of Xs</span></span>
<span id="cb90-332"><a href="#cb90-332" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; displacement, weight, year and origin appear to be significant predictors</span></span>
<span id="cb90-333"><a href="#cb90-333" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; hat(beta)_year &gt;  0 ==&gt; newer cars get better gas mileage</span></span>
<span id="cb90-334"><a href="#cb90-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-335"><a href="#cb90-335" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plots</span></span>
<span id="cb90-336"><a href="#cb90-336" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_car_mlr, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb90-337"><a href="#cb90-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-338"><a href="#cb90-338" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; unequal variance</span></span>
<span id="cb90-339"><a href="#cb90-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-340"><a href="#cb90-340" aria-hidden="true" tabindex="-1"></a><span class="co"># search for higher order effects</span></span>
<span id="cb90-341"><a href="#cb90-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-342"><a href="#cb90-342" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals</span></span>
<span id="cb90-343"><a href="#cb90-343" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod_car_mlr) </span>
<span id="cb90-344"><a href="#cb90-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-345"><a href="#cb90-345" aria-hidden="true" tabindex="-1"></a><span class="co"># plot against each X</span></span>
<span id="cb90-346"><a href="#cb90-346" aria-hidden="true" tabindex="-1"></a>nms_x <span class="ot">&lt;-</span> <span class="fu">colnames</span>(mod_car_mlr<span class="sc">$</span>x[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb90-347"><a href="#cb90-347" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(<span class="fu">data.frame</span>(mod_car_mlr<span class="sc">$</span>x)[, <span class="sc">-</span><span class="dv">1</span>], nms_x, <span class="cf">function</span>(x, nm) {</span>
<span id="cb90-348"><a href="#cb90-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> e, <span class="at">main =</span> nm)</span>
<span id="cb90-349"><a href="#cb90-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="at">x =</span> x, <span class="at">y =</span> e), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb90-350"><a href="#cb90-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb90-351"><a href="#cb90-351" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb90-352"><a href="#cb90-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-353"><a href="#cb90-353" aria-hidden="true" tabindex="-1"></a><span class="co"># if there is relationship of any kind, that indicates there is something more going on because we have controlled for the linear main effects</span></span>
<span id="cb90-354"><a href="#cb90-354" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; something with displacement, horsepower, weight, and, year</span></span>
<span id="cb90-355"><a href="#cb90-355" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; combined with the hereditary principle, these seem like good variables</span></span>
<span id="cb90-356"><a href="#cb90-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-357"><a href="#cb90-357" aria-hidden="true" tabindex="-1"></a><span class="co"># try interaction effects</span></span>
<span id="cb90-358"><a href="#cb90-358" aria-hidden="true" tabindex="-1"></a>mod_car_int <span class="ot">&lt;-</span> <span class="fu">update</span>(mod_car_mlr, . <span class="sc">~</span> . <span class="sc">+</span> displacement<span class="sc">:</span>weight <span class="sc">+</span> displacement<span class="sc">:</span>year <span class="sc">+</span> displacement<span class="sc">:</span>origin <span class="sc">+</span> weight<span class="sc">:</span>year <span class="sc">+</span> weight<span class="sc">:</span>origin <span class="sc">+</span> year<span class="sc">:</span>origin, <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-359"><a href="#cb90-359" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_car_int)</span>
<span id="cb90-360"><a href="#cb90-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-361"><a href="#cb90-361" aria-hidden="true" tabindex="-1"></a><span class="co"># only a couple of the interactions are significant</span></span>
<span id="cb90-362"><a href="#cb90-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-363"><a href="#cb90-363" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_car_int, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb90-364"><a href="#cb90-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-365"><a href="#cb90-365" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals</span></span>
<span id="cb90-366"><a href="#cb90-366" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod_car_int) </span>
<span id="cb90-367"><a href="#cb90-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-368"><a href="#cb90-368" aria-hidden="true" tabindex="-1"></a><span class="co"># plot against each X</span></span>
<span id="cb90-369"><a href="#cb90-369" aria-hidden="true" tabindex="-1"></a>nms_x <span class="ot">&lt;-</span> <span class="fu">colnames</span>(mod_car_int<span class="sc">$</span>x[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb90-370"><a href="#cb90-370" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(<span class="fu">data.frame</span>(mod_car_int<span class="sc">$</span>x)[, <span class="sc">-</span><span class="dv">1</span>], nms_x, <span class="cf">function</span>(x, nm) {</span>
<span id="cb90-371"><a href="#cb90-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">y =</span> e, <span class="at">main =</span> nm)</span>
<span id="cb90-372"><a href="#cb90-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">lowess</span>(<span class="at">x =</span> x, <span class="at">y =</span> e), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb90-373"><a href="#cb90-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span>
<span id="cb90-374"><a href="#cb90-374" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb90-375"><a href="#cb90-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-376"><a href="#cb90-376" aria-hidden="true" tabindex="-1"></a><span class="co"># now only unequal variance is left after controlling for interactions as well</span></span>
<span id="cb90-377"><a href="#cb90-377" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; except for maybe year</span></span>
<span id="cb90-378"><a href="#cb90-378" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; every function of year is significant</span></span>
<span id="cb90-379"><a href="#cb90-379" aria-hidden="true" tabindex="-1"></a>mod_car_int2 <span class="ot">&lt;-</span> <span class="fu">update</span>(mod_car_int, . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">sqrt</span>(year), <span class="at">data =</span> data_car)</span>
<span id="cb90-380"><a href="#cb90-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-381"><a href="#cb90-381" aria-hidden="true" tabindex="-1"></a><span class="co"># see if significant</span></span>
<span id="cb90-382"><a href="#cb90-382" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_car_int2, mod_car_int)</span>
<span id="cb90-383"><a href="#cb90-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-384"><a href="#cb90-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-385"><a href="#cb90-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-386"><a href="#cb90-386" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 10</span></span>
<span id="cb90-387"><a href="#cb90-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-390"><a href="#cb90-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-391"><a href="#cb90-391" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data</span></span>
<span id="cb90-392"><a href="#cb90-392" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; price = quan, urban and us = qual</span></span>
<span id="cb90-393"><a href="#cb90-393" aria-hidden="true" tabindex="-1"></a>data_seats <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Carseats</span>
<span id="cb90-394"><a href="#cb90-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-395"><a href="#cb90-395" aria-hidden="true" tabindex="-1"></a><span class="co"># fit mlr model</span></span>
<span id="cb90-396"><a href="#cb90-396" aria-hidden="true" tabindex="-1"></a>mod_seats <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> Price <span class="sc">+</span> Urban <span class="sc">+</span> US, <span class="at">data =</span> data_seats, <span class="at">x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-397"><a href="#cb90-397" aria-hidden="true" tabindex="-1"></a>mod_seats <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-398"><a href="#cb90-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-399"><a href="#cb90-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-400"><a href="#cb90-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-401"><a href="#cb90-401" aria-hidden="true" tabindex="-1"></a>Coefficient interpretations</span>
<span id="cb90-402"><a href="#cb90-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-403"><a href="#cb90-403" aria-hidden="true" tabindex="-1"></a>$\hat{\beta}_0$ = <span class="in">`r mod_seats %&gt;% broom::tidy() %&gt;% filter(term == "(Intercept)") %&gt;% pull(estimate) %&gt;% round(3)`</span>: For a non-urban store located outside of the US, we expect there to be 13,043 car seat sales on average.</span>
<span id="cb90-404"><a href="#cb90-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-405"><a href="#cb90-405" aria-hidden="true" tabindex="-1"></a>$\hat{\beta}_{\text{Price}}$ = <span class="in">`r mod_seats %&gt;% broom::tidy() %&gt;% filter(term == "Price") %&gt;% pull(estimate) %&gt;% round(3)`</span>: For each dollar increase in the price of the carseat, we expect the unit sales to decrease by approximately 54 units, on average. </span>
<span id="cb90-406"><a href="#cb90-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-407"><a href="#cb90-407" aria-hidden="true" tabindex="-1"></a>$\hat{\beta}_{\text{UrbanYes}}$ = <span class="in">`r mod_seats %&gt;% broom::tidy() %&gt;% filter(term == "UrbanYes") %&gt;% pull(estimate) %&gt;% round(3)`</span>: Stores located in urban areas have approximately 22 less sales on average than non-urban stores.</span>
<span id="cb90-408"><a href="#cb90-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-409"><a href="#cb90-409" aria-hidden="true" tabindex="-1"></a>$\hat{\beta}_{\text{USYes}}$ = <span class="in">`r mod_seats %&gt;% broom::tidy() %&gt;% filter(term == "USYes") %&gt;% pull(estimate) %&gt;% round(3)`</span>: US stores have approximately 1201 more sales on average than non-US stores.</span>
<span id="cb90-410"><a href="#cb90-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-411"><a href="#cb90-411" aria-hidden="true" tabindex="-1"></a>Written-out model</span>
<span id="cb90-412"><a href="#cb90-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-413"><a href="#cb90-413" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-414"><a href="#cb90-414" aria-hidden="true" tabindex="-1"></a>\text{Sales} = \Bigg(\hat{\beta}_0 + \begin{cases}</span>
<span id="cb90-415"><a href="#cb90-415" aria-hidden="true" tabindex="-1"></a>   \hat{\beta}_{\text{UrbanYes}},     &amp; \text{if $\text{Urban}$ = Yes, $\text{US}$ = No} <span class="sc">\\</span></span>
<span id="cb90-416"><a href="#cb90-416" aria-hidden="true" tabindex="-1"></a>    \hat{\beta}_{\text{USYes}},    &amp; \text{if $\text{Urban}$ = No, $\text{US}$ = Yes} <span class="sc">\\</span></span>
<span id="cb90-417"><a href="#cb90-417" aria-hidden="true" tabindex="-1"></a>    \hat{\beta}_{\text{UrbanYes}} + \hat{\beta}_{\text{USYes}},    &amp; \text{if $\text{Urban}$ = $\text{US}$ = Yes} <span class="sc">\\</span></span>
<span id="cb90-418"><a href="#cb90-418" aria-hidden="true" tabindex="-1"></a>    0,       &amp; \text{Otherwise}</span>
<span id="cb90-419"><a href="#cb90-419" aria-hidden="true" tabindex="-1"></a>\end{cases}\Bigg)</span>
<span id="cb90-420"><a href="#cb90-420" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>\hat{\beta}_{\text{Price}} \times \text{Price}</span>
<span id="cb90-421"><a href="#cb90-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-422"><a href="#cb90-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-423"><a href="#cb90-423" aria-hidden="true" tabindex="-1"></a>which come out to be</span>
<span id="cb90-424"><a href="#cb90-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-425"><a href="#cb90-425" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-426"><a href="#cb90-426" aria-hidden="true" tabindex="-1"></a>\text{Sales} = \Bigg(13 + \begin{cases}</span>
<span id="cb90-427"><a href="#cb90-427" aria-hidden="true" tabindex="-1"></a>   -0.022,   &amp; \text{if $\text{Urban}$ is Yes, $\text{US}$ is No} <span class="sc">\\</span></span>
<span id="cb90-428"><a href="#cb90-428" aria-hidden="true" tabindex="-1"></a>    1.20,    &amp; \text{if $\text{Urban}$ is No, $\text{US}$ is Yes} <span class="sc">\\</span></span>
<span id="cb90-429"><a href="#cb90-429" aria-hidden="true" tabindex="-1"></a>    1.18,    &amp; \text{if $\text{Urban}$ and $\text{US}$ is Yes} <span class="sc">\\</span></span>
<span id="cb90-430"><a href="#cb90-430" aria-hidden="true" tabindex="-1"></a>    0,       &amp; \text{Otherwise}</span>
<span id="cb90-431"><a href="#cb90-431" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb90-432"><a href="#cb90-432" aria-hidden="true" tabindex="-1"></a>\Bigg)</span>
<span id="cb90-433"><a href="#cb90-433" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>0.054 \times \textit{Price}</span>
<span id="cb90-434"><a href="#cb90-434" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-435"><a href="#cb90-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-438"><a href="#cb90-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-439"><a href="#cb90-439" aria-hidden="true" tabindex="-1"></a><span class="co"># reject null for Price and US (not for Urban)</span></span>
<span id="cb90-440"><a href="#cb90-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-441"><a href="#cb90-441" aria-hidden="true" tabindex="-1"></a><span class="co"># fit smaller model and test</span></span>
<span id="cb90-442"><a href="#cb90-442" aria-hidden="true" tabindex="-1"></a>mod_seats2 <span class="ot">&lt;-</span> <span class="fu">update</span>(mod_seats, . <span class="sc">~</span> . <span class="sc">-</span> Urban)</span>
<span id="cb90-443"><a href="#cb90-443" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_seats, mod_seats2)</span>
<span id="cb90-444"><a href="#cb90-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-445"><a href="#cb90-445" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; fail to reject --&gt; reduced model is better</span></span>
<span id="cb90-446"><a href="#cb90-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-447"><a href="#cb90-447" aria-hidden="true" tabindex="-1"></a>mod_seats <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(r.squared)</span>
<span id="cb90-448"><a href="#cb90-448" aria-hidden="true" tabindex="-1"></a>mod_seats2 <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(r.squared)</span>
<span id="cb90-449"><a href="#cb90-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-450"><a href="#cb90-450" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; just about the same fit</span></span>
<span id="cb90-451"><a href="#cb90-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-452"><a href="#cb90-452" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence intervals for coefficients on reduced model</span></span>
<span id="cb90-453"><a href="#cb90-453" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_seats2)</span>
<span id="cb90-454"><a href="#cb90-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-455"><a href="#cb90-455" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect for outliers / high leverage observations</span></span>
<span id="cb90-456"><a href="#cb90-456" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_seats2)</span>
<span id="cb90-457"><a href="#cb90-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-458"><a href="#cb90-458" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; there are a few high leverage points, but they are not influential</span></span>
<span id="cb90-459"><a href="#cb90-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-460"><a href="#cb90-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-461"><a href="#cb90-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-462"><a href="#cb90-462" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 11</span></span>
<span id="cb90-463"><a href="#cb90-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-466"><a href="#cb90-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-467"><a href="#cb90-467" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb90-468"><a href="#cb90-468" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb90-469"><a href="#cb90-469" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb90-470"><a href="#cb90-470" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb90-471"><a href="#cb90-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-472"><a href="#cb90-472" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models without intercept</span></span>
<span id="cb90-473"><a href="#cb90-473" aria-hidden="true" tabindex="-1"></a>mod_yx <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="dv">0</span>)</span>
<span id="cb90-474"><a href="#cb90-474" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_yx)</span>
<span id="cb90-475"><a href="#cb90-475" aria-hidden="true" tabindex="-1"></a>mod_xy <span class="ot">&lt;-</span> <span class="fu">lm</span>(x <span class="sc">~</span> y <span class="sc">+</span> <span class="dv">0</span>)</span>
<span id="cb90-476"><a href="#cb90-476" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_xy)</span>
<span id="cb90-477"><a href="#cb90-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-478"><a href="#cb90-478" aria-hidden="true" tabindex="-1"></a><span class="co"># results</span></span>
<span id="cb90-479"><a href="#cb90-479" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; different estimates, same test-statistics</span></span>
<span id="cb90-480"><a href="#cb90-480" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; this can be shown mathematically using the derived formulas for regression without an intercept</span></span>
<span id="cb90-481"><a href="#cb90-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-482"><a href="#cb90-482" aria-hidden="true" tabindex="-1"></a><span class="co"># now with an intercept, show test statistics are the same for y ~ x and x ~ y</span></span>
<span id="cb90-483"><a href="#cb90-483" aria-hidden="true" tabindex="-1"></a>mod_yx <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb90-484"><a href="#cb90-484" aria-hidden="true" tabindex="-1"></a>mod_yx <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>()</span>
<span id="cb90-485"><a href="#cb90-485" aria-hidden="true" tabindex="-1"></a>mod_xy <span class="ot">&lt;-</span> <span class="fu">lm</span>(x <span class="sc">~</span> y)</span>
<span id="cb90-486"><a href="#cb90-486" aria-hidden="true" tabindex="-1"></a>mod_xy <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>()</span>
<span id="cb90-487"><a href="#cb90-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-488"><a href="#cb90-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-489"><a href="#cb90-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-490"><a href="#cb90-490" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 12</span></span>
<span id="cb90-491"><a href="#cb90-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-492"><a href="#cb90-492" aria-hidden="true" tabindex="-1"></a>Can show that estimates will be the same if swap $X$ and $Y$ variables under a certain condition.</span>
<span id="cb90-493"><a href="#cb90-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-494"><a href="#cb90-494" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-495"><a href="#cb90-495" aria-hidden="true" tabindex="-1"></a>Y \sim X: \hat\beta = \sum_i x_iy_i / \sum_{i'} x_{i'}^2</span>
<span id="cb90-496"><a href="#cb90-496" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-497"><a href="#cb90-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-498"><a href="#cb90-498" aria-hidden="true" tabindex="-1"></a>The coefficient for the regression of X onto Y swaps the $x$ and $y$ variables:</span>
<span id="cb90-499"><a href="#cb90-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-500"><a href="#cb90-500" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-501"><a href="#cb90-501" aria-hidden="true" tabindex="-1"></a>X \sim Y: \hat\beta = \sum_i x_iy_i / \sum_{i'} y_{i'}^2</span>
<span id="cb90-502"><a href="#cb90-502" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-503"><a href="#cb90-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-504"><a href="#cb90-504" aria-hidden="true" tabindex="-1"></a>So they are the same when $\sum_{i} x_{i}^2 = \sum_{i} y_{i}^2$</span>
<span id="cb90-505"><a href="#cb90-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-506"><a href="#cb90-506" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 13</span></span>
<span id="cb90-507"><a href="#cb90-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-510"><a href="#cb90-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-511"><a href="#cb90-511" aria-hidden="true" tabindex="-1"></a><span class="co"># investigate coefficient confidence intervals based on the amount of noise</span></span>
<span id="cb90-512"><a href="#cb90-512" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb90-513"><a href="#cb90-513" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb90-514"><a href="#cb90-514" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb90-515"><a href="#cb90-515" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb90-516"><a href="#cb90-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-517"><a href="#cb90-517" aria-hidden="true" tabindex="-1"></a><span class="co"># generate three response vecotrs with difference error variances</span></span>
<span id="cb90-518"><a href="#cb90-518" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">map</span>(\(epsilon) beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, epsilon))</span>
<span id="cb90-519"><a href="#cb90-519" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"original epsilon"</span>, <span class="st">"smaller epsilon"</span>, <span class="st">"larger epsilon"</span>)</span>
<span id="cb90-520"><a href="#cb90-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-521"><a href="#cb90-521" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models based on same x</span></span>
<span id="cb90-522"><a href="#cb90-522" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span> <span class="fu">map</span>(\(y) <span class="fu">lm</span>(y <span class="sc">~</span> x))</span>
<span id="cb90-523"><a href="#cb90-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-524"><a href="#cb90-524" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate coefficient confidence intervals</span></span>
<span id="cb90-525"><a href="#cb90-525" aria-hidden="true" tabindex="-1"></a>mods <span class="sc">%&gt;%</span> <span class="fu">map</span>(\(mod) <span class="fu">coef</span>(mod)[<span class="dv">2</span>])</span>
<span id="cb90-526"><a href="#cb90-526" aria-hidden="true" tabindex="-1"></a>mods <span class="sc">%&gt;%</span> <span class="fu">map</span>(\(mod) <span class="fu">confint</span>(mod))</span>
<span id="cb90-527"><a href="#cb90-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-528"><a href="#cb90-528" aria-hidden="true" tabindex="-1"></a><span class="co"># wider confidence intervals with more noise as expected, and more biased fits</span></span>
<span id="cb90-529"><a href="#cb90-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-530"><a href="#cb90-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-531"><a href="#cb90-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-532"><a href="#cb90-532" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 14</span></span>
<span id="cb90-533"><a href="#cb90-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-536"><a href="#cb90-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-537"><a href="#cb90-537" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb90-538"><a href="#cb90-538" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb90-539"><a href="#cb90-539" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb90-540"><a href="#cb90-540" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb90-541"><a href="#cb90-541" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb90-542"><a href="#cb90-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-543"><a href="#cb90-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-544"><a href="#cb90-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-545"><a href="#cb90-545" aria-hidden="true" tabindex="-1"></a>The model is of the form:</span>
<span id="cb90-546"><a href="#cb90-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-547"><a href="#cb90-547" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-548"><a href="#cb90-548" aria-hidden="true" tabindex="-1"></a>Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \epsilon</span>
<span id="cb90-549"><a href="#cb90-549" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb90-550"><a href="#cb90-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-551"><a href="#cb90-551" aria-hidden="true" tabindex="-1"></a>The coefficients are $\beta_0 = 2$, $\beta_1 = 2$, $\beta_3 = 0.3$.</span>
<span id="cb90-552"><a href="#cb90-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-555"><a href="#cb90-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-556"><a href="#cb90-556" aria-hidden="true" tabindex="-1"></a><span class="co"># investigate relationship between x1 and x2</span></span>
<span id="cb90-557"><a href="#cb90-557" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x1, x2)</span>
<span id="cb90-558"><a href="#cb90-558" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, x2)</span>
<span id="cb90-559"><a href="#cb90-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-560"><a href="#cb90-560" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb90-561"><a href="#cb90-561" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb90-562"><a href="#cb90-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-563"><a href="#cb90-563" aria-hidden="true" tabindex="-1"></a><span class="co"># compare fitted coefficients to population values, then test</span></span>
<span id="cb90-564"><a href="#cb90-564" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb90-565"><a href="#cb90-565" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-566"><a href="#cb90-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-567"><a href="#cb90-567" aria-hidden="true" tabindex="-1"></a><span class="co"># fail to reject for x2</span></span>
<span id="cb90-568"><a href="#cb90-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-569"><a href="#cb90-569" aria-hidden="true" tabindex="-1"></a><span class="co"># now fit models with the predictors individually</span></span>
<span id="cb90-570"><a href="#cb90-570" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1)</span>
<span id="cb90-571"><a href="#cb90-571" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2)</span>
<span id="cb90-572"><a href="#cb90-572" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-573"><a href="#cb90-573" aria-hidden="true" tabindex="-1"></a>mod2 <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-574"><a href="#cb90-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-575"><a href="#cb90-575" aria-hidden="true" tabindex="-1"></a><span class="co"># both reject</span></span>
<span id="cb90-576"><a href="#cb90-576" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; this contradicts the mlr model where x2 was not significant</span></span>
<span id="cb90-577"><a href="#cb90-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-578"><a href="#cb90-578" aria-hidden="true" tabindex="-1"></a><span class="co"># obtain new observations</span></span>
<span id="cb90-579"><a href="#cb90-579" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x1, <span class="fl">0.1</span>)</span>
<span id="cb90-580"><a href="#cb90-580" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x2, <span class="fl">0.8</span>)</span>
<span id="cb90-581"><a href="#cb90-581" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(y, <span class="dv">6</span>)</span>
<span id="cb90-582"><a href="#cb90-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-583"><a href="#cb90-583" aria-hidden="true" tabindex="-1"></a><span class="co"># refit models and see effect</span></span>
<span id="cb90-584"><a href="#cb90-584" aria-hidden="true" tabindex="-1"></a>mod_new <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb90-585"><a href="#cb90-585" aria-hidden="true" tabindex="-1"></a>mod1_new <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1)</span>
<span id="cb90-586"><a href="#cb90-586" aria-hidden="true" tabindex="-1"></a>mod2_new <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2)</span>
<span id="cb90-587"><a href="#cb90-587" aria-hidden="true" tabindex="-1"></a>mod_new <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-588"><a href="#cb90-588" aria-hidden="true" tabindex="-1"></a>mod1_new <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-589"><a href="#cb90-589" aria-hidden="true" tabindex="-1"></a>mod2_new <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb90-590"><a href="#cb90-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-591"><a href="#cb90-591" aria-hidden="true" tabindex="-1"></a><span class="co"># seems similar results in the individual predictor models, however in the mlr model now both are significant -&gt; investigate why</span></span>
<span id="cb90-592"><a href="#cb90-592" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_new) <span class="co"># high leverage with respect to x1 and x2</span></span>
<span id="cb90-593"><a href="#cb90-593" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x1)</span>
<span id="cb90-594"><a href="#cb90-594" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">0.1</span>, <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="co"># outlier in y</span></span>
<span id="cb90-595"><a href="#cb90-595" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x2)</span>
<span id="cb90-596"><a href="#cb90-596" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">0.8</span>, <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="co"># high leverage (i.e. outlier in x)</span></span>
<span id="cb90-597"><a href="#cb90-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-598"><a href="#cb90-598" aria-hidden="true" tabindex="-1"></a><span class="co"># useful to consider plot of the xs</span></span>
<span id="cb90-599"><a href="#cb90-599" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, x2)</span>
<span id="cb90-600"><a href="#cb90-600" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb90-601"><a href="#cb90-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-602"><a href="#cb90-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-603"><a href="#cb90-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-604"><a href="#cb90-604" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Question 15</span></span>
<span id="cb90-605"><a href="#cb90-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-608"><a href="#cb90-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-609"><a href="#cb90-609" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data</span></span>
<span id="cb90-610"><a href="#cb90-610" aria-hidden="true" tabindex="-1"></a>data_boston <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Boston</span>
<span id="cb90-611"><a href="#cb90-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-612"><a href="#cb90-612" aria-hidden="true" tabindex="-1"></a><span class="co"># fit many SLR models</span></span>
<span id="cb90-613"><a href="#cb90-613" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> data_boston <span class="sc">%&gt;%</span> </span>
<span id="cb90-614"><a href="#cb90-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>crim) <span class="sc">%&gt;%</span> </span>
<span id="cb90-615"><a href="#cb90-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(\(x) <span class="fu">lm</span>(data_boston<span class="sc">$</span>crim <span class="sc">~</span> x))</span>
<span id="cb90-616"><a href="#cb90-616" aria-hidden="true" tabindex="-1"></a>mods <span class="sc">%&gt;%</span> <span class="fu">map</span>(\(mod) broom<span class="sc">::</span><span class="fu">glance</span>(mod)[<span class="dv">1</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb90-617"><a href="#cb90-617" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; all significant except chas</span></span>
<span id="cb90-618"><a href="#cb90-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-619"><a href="#cb90-619" aria-hidden="true" tabindex="-1"></a><span class="co"># fit mlr model</span></span>
<span id="cb90-620"><a href="#cb90-620" aria-hidden="true" tabindex="-1"></a>mod_mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>( crim <span class="sc">~</span> ., <span class="at">data =</span> data_boston)</span>
<span id="cb90-621"><a href="#cb90-621" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_mlr)</span>
<span id="cb90-622"><a href="#cb90-622" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; can now only reject for zn, nox, dis, rad, lstat and medv</span></span>
<span id="cb90-623"><a href="#cb90-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-624"><a href="#cb90-624" aria-hidden="true" tabindex="-1"></a><span class="co"># extract two sets of coefficients and plot against each other</span></span>
<span id="cb90-625"><a href="#cb90-625" aria-hidden="true" tabindex="-1"></a>betas_slr <span class="ot">&lt;-</span> mods <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(\(mod) broom<span class="sc">::</span><span class="fu">tidy</span>(mod)[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">%&gt;%</span> as.numeric)</span>
<span id="cb90-626"><a href="#cb90-626" aria-hidden="true" tabindex="-1"></a>betas_mlr <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod_mlr)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb90-627"><a href="#cb90-627" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(betas_mlr <span class="sc">~</span> betas_slr)</span>
<span id="cb90-628"><a href="#cb90-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-629"><a href="#cb90-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-630"><a href="#cb90-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-631"><a href="#cb90-631" aria-hidden="true" tabindex="-1"></a>The estimated coefficients differ (in particular the estimated coefficient for</span>
<span id="cb90-632"><a href="#cb90-632" aria-hidden="true" tabindex="-1"></a><span class="in">`nox`</span> is dramatically different) between the two modelling strategies.</span>
<span id="cb90-633"><a href="#cb90-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-636"><a href="#cb90-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-637"><a href="#cb90-637" aria-hidden="true" tabindex="-1"></a><span class="co"># fit many cubic models models</span></span>
<span id="cb90-638"><a href="#cb90-638" aria-hidden="true" tabindex="-1"></a>mods_cubic <span class="ot">&lt;-</span> data_boston <span class="sc">%&gt;%</span> </span>
<span id="cb90-639"><a href="#cb90-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(crim, chas)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-640"><a href="#cb90-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(\(x) <span class="fu">lm</span>(data_boston<span class="sc">$</span>crim <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>)))</span>
<span id="cb90-641"><a href="#cb90-641" aria-hidden="true" tabindex="-1"></a>mods_cubic <span class="sc">%&gt;%</span> <span class="fu">map</span>(\(mod) broom<span class="sc">::</span><span class="fu">tidy</span>(mod))</span>
<span id="cb90-642"><a href="#cb90-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-643"><a href="#cb90-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-644"><a href="#cb90-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-645"><a href="#cb90-645" aria-hidden="true" tabindex="-1"></a>Several models have a significant cubic term, if not then the quadratic term is significant for the rest.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>